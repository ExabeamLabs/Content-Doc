Vendor: Microsoft
=================
Product: Web Application Proxy
------------------------------
| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  117  |   39   |     24     |      3      |    3    |

|    Use-Case    | Event Types/Parsers    | MITRE TTP    | Content    |
|:----:| ---- | ---- | ---- |
| [Abnormal Authentication & Access](../../../UseCases/uc_abnormal_authentication_&_access.md) |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1071 - Application Layer Protocol<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1078 - Valid Accounts<br>T1110 - Brute Force<br>    | [<ul><li>14 Rules</li></ul><ul><li>9 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Abnormal_Authentication_&_Access.md) |
|    [Brute Force Attack](../../../UseCases/uc_brute_force_attack.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1021.001 - Remote Services: Remote Desktop Protocol<br>T1110 - Brute Force<br>    | [<ul><li>3 Rules</li></ul>](RM/r_m_microsoft_web_application_proxy_Brute_Force_Attack.md)    |
|          [Compromised Credentials](../../../UseCases/uc_compromised_credentials.md)          |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1071 - Application Layer Protocol<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1078 - Valid Accounts<br>T1102 - Web Service<br>T1189 - Drive-by Compromise<br>T1204.001 - T1204.001<br>T1550.002 - Use Alternate Authentication Material: Pass the Hash<br>T1566.002 - Phishing: Spearphishing Link<br>    | [<ul><li>37 Rules</li></ul><ul><li>15 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Compromised_Credentials.md)         |
|    [Cryptomining](../../../UseCases/uc_cryptomining.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1496 - Resource Hijacking<br>    | [<ul><li>3 Rules</li></ul>](RM/r_m_microsoft_web_application_proxy_Cryptomining.md)    |
|    [Data Exfiltration](../../../UseCases/uc_data_exfiltration.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1030 - Data Transfer Size Limits<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage<br>T1568 - Dynamic Resolution<br>    | [<ul><li>7 Rules</li></ul><ul><li>2 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Data_Exfiltration.md)    |
|    [Data Leak](../../../UseCases/uc_data_leak.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1030 - Data Transfer Size Limits<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage<br>    | [<ul><li>6 Rules</li></ul><ul><li>3 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Data_Leak.md)    |
|    [Evasion](../../../UseCases/uc_evasion.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1090.003 - Proxy: Multi-hop Proxy<br>T1090.004 - T1090.004<br>    | [<ul><li>8 Rules</li></ul><ul><li>1 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Evasion.md)    |
|    [Lateral Movement](../../../UseCases/uc_lateral_movement.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1021.001 - Remote Services: Remote Desktop Protocol<br>T1048 - Exfiltration Over Alternative Protocol<br>T1071 - Application Layer Protocol<br>T1078 - Valid Accounts<br>T1090.002 - Proxy: External Proxy<br>T1110 - Brute Force<br>T1550.002 - Use Alternate Authentication Material: Pass the Hash<br>T1550.003 - Use Alternate Authentication Material: Pass the Ticket<br>T1550.004 - Use Alternate Authentication Material: Web Session Cookie<br>T1571 - Non-Standard Port<br> | [<ul><li>17 Rules</li></ul><ul><li>9 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Lateral_Movement.md)    |
|    [Malware](../../../UseCases/uc_malware.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1071 - Application Layer Protocol<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1090.003 - Proxy: Multi-hop Proxy<br>T1189 - Drive-by Compromise<br>T1204.001 - T1204.001<br>T1210 - Exploitation of Remote Services<br>T1550.002 - Use Alternate Authentication Material: Pass the Hash<br>T1566.002 - Phishing: Spearphishing Link<br>T1568.002 - Dynamic Resolution: Domain Generation Algorithms<br>    | [<ul><li>30 Rules</li></ul><ul><li>8 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Malware.md)    |
|    [Other](../../../UseCases/uc_other.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> |    | [<ul><li>15 Rules</li></ul><ul><li>1 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Other.md)    |
|    [Phishing](../../../UseCases/uc_phishing.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1566.002 - Phishing: Spearphishing Link<br>    | [<ul><li>3 Rules</li></ul>](RM/r_m_microsoft_web_application_proxy_Phishing.md)    |
|    [Privilege Abuse](../../../UseCases/uc_privilege_abuse.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1078 - Valid Accounts<br>    | [<ul><li>3 Rules</li></ul><ul><li>1 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Privilege_Abuse.md)    |
|    [Privilege Escalation](../../../UseCases/uc_privilege_escalation.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1210 - Exploitation of Remote Services<br>    | [<ul><li>1 Rules</li></ul>](RM/r_m_microsoft_web_application_proxy_Privilege_Escalation.md)    |
|    [Privileged Activity](../../../UseCases/uc_privileged_activity.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1068 - Exploitation for Privilege Escalation<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1078 - Valid Accounts<br>T1102 - Web Service<br>    | [<ul><li>4 Rules</li></ul>](RM/r_m_microsoft_web_application_proxy_Privileged_Activity.md)    |
|    [Ransomware](../../../UseCases/uc_ransomware.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1071 - Application Layer Protocol<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1078 - Valid Accounts<br>    | [<ul><li>3 Rules</li></ul>](RM/r_m_microsoft_web_application_proxy_Ransomware.md)    |
|    [Workforce Protection](../../../UseCases/uc_workforce_protection.md)    |  failed-logon<br> ↳[microsoft-remote-desktop](Ps/pC_microsoftremotedesktop.md)<br><br> network-connection-failed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br><br> web-activity-allowed<br> ↳[tmg-proxy](Ps/pC_tmgproxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>    | [<ul><li>4 Rules</li></ul><ul><li>2 Models</li></ul>](RM/r_m_microsoft_web_application_proxy_Workforce_Protection.md)    |

ATT&CK Matrix for Enterprise
----------------------------
| Initial Access                                                                                                                                                                                                                                                                                | Execution                                                           | Persistence                                                         | Privilege Escalation                                                                                                                                          | Defense Evasion                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | Credential Access                                                | Discovery | Lateral Movement                                                                                                                                                                                                                                                                                                                                    | Collection | Command and Control                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | Exfiltration                                                                                                                                                                                                                                                                                                                                                                     | Impact                                                                  |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------- | ------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------- | --------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
| [Phishing: Spearphishing Link](https://attack.mitre.org/techniques/T1566/002)<br><br>[Valid Accounts](https://attack.mitre.org/techniques/T1078)<br><br>[Drive-by Compromise](https://attack.mitre.org/techniques/T1189)<br><br>[Phishing](https://attack.mitre.org/techniques/T1566)<br><br> | [User Execution](https://attack.mitre.org/techniques/T1204)<br><br> | [Valid Accounts](https://attack.mitre.org/techniques/T1078)<br><br> | [Valid Accounts](https://attack.mitre.org/techniques/T1078)<br><br>[Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)<br><br> | [Valid Accounts](https://attack.mitre.org/techniques/T1078)<br><br>[Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)<br><br>[Use Alternate Authentication Material: Pass the Hash](https://attack.mitre.org/techniques/T1550/002)<br><br>[Use Alternate Authentication Material: Web Session Cookie](https://attack.mitre.org/techniques/T1550/004)<br><br>[Use Alternate Authentication Material: Pass the Ticket](https://attack.mitre.org/techniques/T1550/003)<br><br> | [Brute Force](https://attack.mitre.org/techniques/T1110)<br><br> |           | [Exploitation of Remote Services](https://attack.mitre.org/techniques/T1210)<br><br>[Remote Services](https://attack.mitre.org/techniques/T1021)<br><br>[Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)<br><br>[Remote Services: Remote Desktop Protocol](https://attack.mitre.org/techniques/T1021/001)<br><br> |            | [Web Service](https://attack.mitre.org/techniques/T1102)<br><br>[Non-Standard Port](https://attack.mitre.org/techniques/T1571)<br><br>[Application Layer Protocol: Web Protocols](https://attack.mitre.org/techniques/T1071/001)<br><br>[Dynamic Resolution](https://attack.mitre.org/techniques/T1568)<br><br>[Dynamic Resolution: Domain Generation Algorithms](https://attack.mitre.org/techniques/T1568/002)<br><br>[Proxy: Multi-hop Proxy](https://attack.mitre.org/techniques/T1090/003)<br><br>[Proxy: External Proxy](https://attack.mitre.org/techniques/T1090/002)<br><br>[Application Layer Protocol](https://attack.mitre.org/techniques/T1071)<br><br>[Proxy](https://attack.mitre.org/techniques/T1090)<br><br> | [Exfiltration Over Alternative Protocol](https://attack.mitre.org/techniques/T1048)<br><br>[Data Transfer Size Limits](https://attack.mitre.org/techniques/T1030)<br><br>[Exfiltration Over Web Service: Exfiltration to Cloud Storage](https://attack.mitre.org/techniques/T1567/002)<br><br>[Exfiltration Over Web Service](https://attack.mitre.org/techniques/T1567)<br><br> | [Resource Hijacking](https://attack.mitre.org/techniques/T1496)<br><br> |