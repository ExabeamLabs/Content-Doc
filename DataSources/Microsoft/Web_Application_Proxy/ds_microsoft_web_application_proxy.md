Vendor: Microsoft
=================
Product: Web Application Proxy
------------------------------
| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  110  |   48   |     20     |      3      |    3    |

|                                           Use-Case                                           | Event Types/Parsers                                                                                                                                                                                                                                                        | MITRE TTP                                                                                                                                                                                                                                                                               | Content                                                                                                                                 |
|:--------------------------------------------------------------------------------------------:| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------- |
|        [3rd Party Security Alerts](../../../UseCases/uc_3rd_party_security_alerts.md)        |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>                                                                                                                                                                                                                               | [<ul><li>3 Rules</li></ul><ul><li>1 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_3rd_Party_Security_Alerts.md)    |
| [Abnormal Authentication & Access](../../../UseCases/uc_abnormal_authentication_&_access.md) |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1078 - Valid Accounts<br>T1133 - External Remote Services<br>                                                                                                                                                                                                                          | [<ul><li>2 Rules</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Abnormal_Authentication_&_Access.md)                       |
|     [Abnormal Network Connections](../../../UseCases/uc_abnormal_network_connections.md)     |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071 - Application Layer Protocol<br>T1071.001 - Application Layer Protocol: Web Protocols<br>                                                                                                                                                                                         | [<ul><li>5 Rules</li></ul><ul><li>2 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Abnormal_Network_Connections.md) |
|           [Abnormal Remote Access](../../../UseCases/uc_abnormal_remote_access.md)           |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1018 - Remote System Discovery<br>T1021 - Remote Services<br>T1075 - T1075<br>T1078 - Valid Accounts<br>T1550 - Use Alternate Authentication Material<br>                                                                                                                              | [<ul><li>8 Rules</li></ul><ul><li>4 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Abnormal_Remote_Access.md)       |
|           [Abnormal User Activity](../../../UseCases/uc_abnormal_user_activity.md)           |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1021 - Remote Services<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1078 - Valid Accounts<br>T1078.003 - Valid Accounts: Local Accounts<br>T1133 - External Remote Services<br>                                                                                        | [<ul><li>20 Rules</li></ul><ul><li>15 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Abnormal_User_Activity.md)     |
|              [Abnormal Web Access](../../../UseCases/uc_abnormal_web_access.md)              |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1102 - Web Service<br>T1550.002 - Use Alternate Authentication Material: Pass the Hash<br>                                                                                                                                    | [<ul><li>30 Rules</li></ul><ul><li>13 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Abnormal_Web_Access.md)        |
|             [Account Manipulation](../../../UseCases/uc_account_manipulation.md)             |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1078 - Valid Accounts<br>                                                                                                                                                                                                                                                              | [<ul><li>1 Rules</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Account_Manipulation.md)                                   |
|                   [Account Switch](../../../UseCases/uc_account_switch.md)                   |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1078 - Valid Accounts<br>                                                                                                                                                                                                                                                              | [<ul><li>2 Rules</li></ul><ul><li>1 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Account_Switch.md)               |
|   [Activity on Domain Controllers](../../../UseCases/uc_activity_on_domain_controllers.md)   |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1102 - Web Service<br>                                                                                                                                                                                                        | [<ul><li>1 Rules</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Activity_on_Domain_Controllers.md)                         |
|               [Brute Force Attack](../../../UseCases/uc_brute_force_attack.md)               |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1078 - Valid Accounts<br>                                                                                                                                                                                                                                                              | [<ul><li>1 Rules</li></ul><ul><li>1 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Brute_Force_Attack.md)           |
|                     [Cryptomining](../../../UseCases/uc_cryptomining.md)                     |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1496 - Resource Hijacking<br>                                                                                                                                                                                                 | [<ul><li>3 Rules</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Cryptomining.md)                                           |
|        [Data Exfiltration via DNS](../../../UseCases/uc_data_exfiltration_via_dns.md)        |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1568 - Dynamic Resolution<br>                                                                                                                                                                                                 | [<ul><li>1 Rules</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Data_Exfiltration_via_DNS.md)                              |
|        [Data Exfiltration via Web](../../../UseCases/uc_data_exfiltration_via_web.md)        |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1030 - Data Transfer Size Limits<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage<br>                                                                                                              | [<ul><li>3 Rules</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Data_Exfiltration_via_Web.md)                              |
|                [Data Leak via Web](../../../UseCases/uc_data_leak_via_web.md)                |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1030 - Data Transfer Size Limits<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1567.002 - Exfiltration Over Web Service: Exfiltration to Cloud Storage<br>                                                                                                              | [<ul><li>4 Rules</li></ul><ul><li>1 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Data_Leak_via_Web.md)            |
|                          [Evasion](../../../UseCases/uc_evasion.md)                          |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1090.003 - Proxy: Multi-hop Proxy<br>                                                                                                                                                                                         | [<ul><li>4 Rules</li></ul><ul><li>1 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Evasion.md)                      |
|          [Executive Account Abuse](../../../UseCases/uc_executive_account_abuse.md)          |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1078 - Valid Accounts<br>                                                                                                                                                                                                                                                              | [<ul><li>1 Rules</li></ul><ul><li>1 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Executive_Account_Abuse.md)      |
|       [Executive Account Activity](../../../UseCases/uc_executive_account_activity.md)       |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1068 - Exploitation for Privilege Escalation<br>T1078 - Valid Accounts<br>                                                                                                                                                                                                             | [<ul><li>2 Rules</li></ul><ul><li>1 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Executive_Account_Activity.md)   |
|                          [Malware](../../../UseCases/uc_malware.md)                          |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071 - Application Layer Protocol<br>T1071.001 - Application Layer Protocol: Web Protocols<br>T1078 - Valid Accounts<br>T1204 - User Execution<br>T1550.002 - Use Alternate Authentication Material: Pass the Hash<br>T1568.002 - Dynamic Resolution: Domain Generation Algorithms<br> | [<ul><li>30 Rules</li></ul><ul><li>8 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Malware.md)                     |
|                    [Pass the Hash](../../../UseCases/uc_pass_the_hash.md)                    |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1550.002 - Use Alternate Authentication Material: Pass the Hash<br>                                                                                                                                                                                                                    | [<ul><li>2 Rules</li></ul><ul><li>2 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Pass_the_Hash.md)                |
|                  [Pass the Ticket](../../../UseCases/uc_pass_the_ticket.md)                  |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1550.002 - Use Alternate Authentication Material: Pass the Hash<br>T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting<br>                                                                                                                                                      | [<ul><li>13 Rules</li></ul><ul><li>6 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Pass_the_Ticket.md)             |
|                         [Phishing](../../../UseCases/uc_phishing.md)                         |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>T1566.002 - Phishing: Spearphishing Link<br>                                                                                                                                                                                   | [<ul><li>1 Rules</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Phishing.md)                                               |
|           [Privileged Asset Abuse](../../../UseCases/uc_privileged_asset_abuse.md)           |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1078 - Valid Accounts<br>                                                                                                                                                                                                                                                              | [<ul><li>1 Rules</li></ul><ul><li>1 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Privileged_Asset_Abuse.md)       |
|                       [Ransomware](../../../UseCases/uc_ransomware.md)                       |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071 - Application Layer Protocol<br>T1078 - Valid Accounts<br>                                                                                                                                                                                                                        | [<ul><li>4 Rules</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Ransomware.md)                                             |
|                [Risk of Attrition](../../../UseCases/uc_risk_of_attrition.md)                |  remote-logon<br> ↳ [microsoft-remote-desktop](Parsers/parserContent_microsoft-remote-desktop.md)<br><br> web-activity-allowed<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br><br> web-activity-denied<br> ↳ [tmg-proxy](Parsers/parserContent_tmg-proxy.md)<br> | T1071.001 - Application Layer Protocol: Web Protocols<br>                                                                                                                                                                                                                               | [<ul><li>3 Rules</li></ul><ul><li>2 Models</li></ul>](Rules_Models/r_m_microsoft_web_application_proxy_Risk_of_Attrition.md)            |

ATT&CK Matrix for Enterprise
----------------------------
| Initial Access                                                                                                                                                                                                                                                                                     | Execution                                                           | Persistence                                                                                                                                      | Privilege Escalation                                                                                                                                          | Defense Evasion                                                                                                                                                                                                                                                                                                                                                   | Credential Access                                                                                                                                                                           | Discovery                                                                    | Lateral Movement                                                                                                                                               | Collection | Command and Control                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Exfiltration                                                                                                                                                                                                                                                                          | Impact                                                                  |
| -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------- |
| [Phishing: Spearphishing Link](https://attack.mitre.org/techniques/T1566/002)<br><br>[External Remote Services](https://attack.mitre.org/techniques/T1133)<br><br>[Valid Accounts](https://attack.mitre.org/techniques/T1078)<br><br>[Phishing](https://attack.mitre.org/techniques/T1566)<br><br> | [User Execution](https://attack.mitre.org/techniques/T1204)<br><br> | [External Remote Services](https://attack.mitre.org/techniques/T1133)<br><br>[Valid Accounts](https://attack.mitre.org/techniques/T1078)<br><br> | [Valid Accounts](https://attack.mitre.org/techniques/T1078)<br><br>[Exploitation for Privilege Escalation](https://attack.mitre.org/techniques/T1068)<br><br> | [Valid Accounts](https://attack.mitre.org/techniques/T1078)<br><br>[Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)<br><br>[Use Alternate Authentication Material: Pass the Hash](https://attack.mitre.org/techniques/T1550/002)<br><br>[Valid Accounts: Local Accounts](https://attack.mitre.org/techniques/T1078/003)<br><br> | [Steal or Forge Kerberos Tickets](https://attack.mitre.org/techniques/T1558)<br><br>[Steal or Forge Kerberos Tickets: Kerberoasting](https://attack.mitre.org/techniques/T1558/003)<br><br> | [Remote System Discovery](https://attack.mitre.org/techniques/T1018)<br><br> | [Remote Services](https://attack.mitre.org/techniques/T1021)<br><br>[Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550)<br><br> |            | [Web Service](https://attack.mitre.org/techniques/T1102)<br><br>[Application Layer Protocol: Web Protocols](https://attack.mitre.org/techniques/T1071/001)<br><br>[Dynamic Resolution](https://attack.mitre.org/techniques/T1568)<br><br>[Dynamic Resolution: Domain Generation Algorithms](https://attack.mitre.org/techniques/T1568/002)<br><br>[Proxy: Multi-hop Proxy](https://attack.mitre.org/techniques/T1090/003)<br><br>[Application Layer Protocol](https://attack.mitre.org/techniques/T1071)<br><br>[Proxy](https://attack.mitre.org/techniques/T1090)<br><br> | [Data Transfer Size Limits](https://attack.mitre.org/techniques/T1030)<br><br>[Exfiltration Over Web Service: Exfiltration to Cloud Storage](https://attack.mitre.org/techniques/T1567/002)<br><br>[Exfiltration Over Web Service](https://attack.mitre.org/techniques/T1567)<br><br> | [Resource Hijacking](https://attack.mitre.org/techniques/T1496)<br><br> |