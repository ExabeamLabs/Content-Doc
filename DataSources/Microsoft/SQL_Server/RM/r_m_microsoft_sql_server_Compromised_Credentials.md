Vendor: Microsoft
=================
### Product: [SQL Server](../ds_microsoft_sql_server.md)
### Use-Case: [Compromised Credentials](../../../../UseCases/uc_compromised_credentials.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  72   |   37   |     11     |      7      |    7    |

| Event Type          | Rules    | Models    |
| ---- | ---- | ---- |
| database-login      | <b>T1213 - Data from Information Repositories</b><br> ↳ <b>DB-DbU-F</b>: First access to database for user<br> ↳ <b>DB-DbU-A</b>: Abnormal access to database for user<br> ↳ <b>DB-DbG-F</b>: First access to database for peer group<br> ↳ <b>DB-DbG-A</b>: Abnormal access to database for peer group<br> ↳ <b>DB-UDbZ-F</b>: First database activity from source zone per user, database<br> ↳ <b>DB-UDbZ-A</b>: Abnormal database activity from source zone per user, database<br> ↳ <b>DB-UDbH-F</b>: First database activity from host per user, database<br> ↳ <b>DB-UDbH-A</b>: Abnormal database activity from host per user, database<br> ↳ <b>DB-UDbI-F</b>: First database activity from IP per user, database<br> ↳ <b>DB-UDbI-A</b>: Abnormal database activity from IP per user, database    |  • <b>DB-UDbI</b>: Database activity from source IP per user, database<br> • <b>DB-UDbH</b>: Database activity from host per user, database<br> • <b>DB-UDbZ</b>: Database activity from source zone per user, database<br> • <b>DB-DbG</b>: Peer groups per database<br> • <b>DB-DbU</b>: Users per database    |
| database-query      | <b>T1213 - Data from Information Repositories</b><br> ↳ <b>DB-DbU-F</b>: First access to database for user<br> ↳ <b>DB-DbU-A</b>: Abnormal access to database for user<br> ↳ <b>DB-DbG-F</b>: First access to database for peer group<br> ↳ <b>DB-DbG-A</b>: Abnormal access to database for peer group<br> ↳ <b>DB-UDbZ-F</b>: First database activity from source zone per user, database<br> ↳ <b>DB-UDbZ-A</b>: Abnormal database activity from source zone per user, database<br> ↳ <b>DB-UDbH-F</b>: First database activity from host per user, database<br> ↳ <b>DB-UDbH-A</b>: Abnormal database activity from host per user, database<br> ↳ <b>DB-UDbI-F</b>: First database activity from IP per user, database<br> ↳ <b>DB-UDbI-A</b>: Abnormal database activity from IP per user, database<br> ↳ <b>DB-UDbO-F</b>: First database operation for user, database<br> ↳ <b>DB-UDbO-A</b>: Abnormal database operation for user, database<br> ↳ <b>DB-GDbO-F</b>: First database operation for peer group, database<br> ↳ <b>DB-GDbO-A</b>: Abnormal database operation for peer group, database<br> ↳ <b>DB-DbZO-F</b>: First database operation from source zone for database<br> ↳ <b>DB-DbZO-A</b>: Abnormal database operation from source zone for database<br> ↳ <b>DB-UDbR</b>: Abnormal database query response size for user, database<br> ↳ <b>DB-DbZR</b>: Abnormal database query response size for source zone, database    |  • <b>DB-DbZR</b>: Response size of database queries per zone, database<br> • <b>DB-UDbR</b>: Response size of database queries per user, database<br> • <b>DB-DbZO</b>: Database operations per database, source zone<br> • <b>DB-GDbO</b>: Database operations per peer group, database<br> • <b>DB-UDbO</b>: Database operations per user, database<br> • <b>DB-UDbI</b>: Database activity from source IP per user, database<br> • <b>DB-UDbH</b>: Database activity from host per user, database<br> • <b>DB-UDbZ</b>: Database activity from source zone per user, database<br> • <b>DB-DbG</b>: Peer groups per database<br> • <b>DB-DbU</b>: Users per database    |
| failed-app-login    | <b>T1078 - Valid Accounts</b><br> ↳ <b>APP-F-FL</b>: Failed login to application    |    |
| file-read    | <b>T1003.001 - T1003.001</b><br> ↳ <b>A-FA-LSASS</b>: Possible Mimikatz attack on this asset by a user process<br> ↳ <b>FA-LSASS</b>: Possible Mimikatz attack by a user process<br><br><b>T1083 - File and Directory Discovery</b><br> ↳ <b>FA-UA-UI-F</b>: First file activity from ISP<br> ↳ <b>FA-UA-UC-F</b>: First file activity from country for user<br> ↳ <b>FA-UA-UC-A</b>: Abnormal file activity from country for user<br> ↳ <b>FA-UA-GC-F</b>: First file activity from country for group<br> ↳ <b>FA-UA-GC-A</b>: Abnormal file activity from country for group<br> ↳ <b>FA-UA-OC-F</b>: First file activity from country for organization<br> ↳ <b>FA-UA-OC-A</b>: Abnormal file activity from country for organization<br> ↳ <b>FA-UTi</b>: Abnormal user file activity time<br> ↳ <b>FA-UH-F</b>: First file access from asset for user<br> ↳ <b>FA-UH-A</b>: Abnormal file access from asset for user<br> ↳ <b>FA-OZ-F</b>: First file access from network zone for organization<br> ↳ <b>FA-OZ-A</b>: Abnormal file access from network zone for organization<br> ↳ <b>FA-UZ-F</b>: First file access from network zone for user<br> ↳ <b>FA-UZ-A</b>: Abnormal file access from network zone for user<br> ↳ <b>FA-UA-F</b>: First file access activity for user<br> ↳ <b>FA-UA-A</b>: Abnormal file access activity for user<br> ↳ <b>FA-OU-F</b>: First access to source code files for user in the organization<br> ↳ <b>FA-OU-A</b>: Abnormal access to source code files for user in the organization<br> ↳ <b>FA-OG-F</b>: First access to source code files for user in the peer group<br> ↳ <b>FA-OG-A</b>: Abnormal access to source code files for user in the peer group<br> ↳ <b>FA-UD-F</b>: First file server access for user<br> ↳ <b>FA-UD-A</b>: Abnormal file server access for user<br> ↳ <b>FA-GD-F</b>: First file server access for group<br> ↳ <b>FA-GD-A</b>: Abnormal file server access for group<br><br><b>T1003.003 - T1003.003</b><br> ↳ <b>A-NTDS-Access-F</b>: The NTDS database was accessed from a new location on this asset.<br> ↳ <b>A-NTDS-Access-A</b>: The NTDS database was accessed from a non default location on this asset.<br> ↳ <b>A-NTDS-Access</b>: The NTDS database was accessed from a non default location without 'ntds.dit' in the file path on this asset.    |  • <b>FA-GD</b>: File server access per group<br> • <b>FA-UD</b>: File server access per user<br> • <b>FA-OG</b>: Users accessing source code files in the peer group<br> • <b>FA-OU</b>: Users accessing source code files in the organization<br> • <b>FA-UA</b>: File access activities for user<br> • <b>FA-UZ</b>: File accesses from network zone for user<br> • <b>FA-OZ</b>: File accesses from network zone for organization<br> • <b>FA-UH</b>: User file access source host<br> • <b>FA-UTi</b>: File activity time for user<br> • <b>FA-UA-OC</b>: Countries for organization file activities<br> • <b>FA-UA-GC</b>: Countries for peer groups file activities<br> • <b>FA-UA-UC</b>: Countries for user file activity<br> • <b>FA-UA-UI-new</b>: ISP of users during file activity<br> • <b>A-NTDS-Access</b>: Models the amount of accesses to paths that are related to NTDS    |
| web-activity-denied | <b>T1071.001 - Application Layer Protocol: Web Protocols</b><br> ↳ <b>A-WEB-HA-F</b>: First web activity event on asset<br> ↳ <b>A-WEB-DC</b>: Web activity event on a Domain Controller<br> ↳ <b>A-WEBF-IP-Country-F</b>: Asset failed to directly connect to an IP address in a country never before accessed<br> ↳ <b>A-WEBF-IP-Country-A</b>: Abnormal direct access to an IP address by the asset belonging to an abnormal country for the asset to access has failed<br> ↳ <b>A-NETF-HCountry-Outbound-WEB-F</b>: First failed web browsing connection to this country from asset<br> ↳ <b>A-NETF-HCountry-Outbound-WEB-A</b>: Web browsing connection to abnormal country for asset has failed<br> ↳ <b>A-NETF-OCountry-Outbound-WEB-F</b>: First failed web browsing connection to this country from organization<br> ↳ <b>A-NETF-OCountry-Outbound-WEB-A</b>: Web browsing connection to abnormal country for the organization has failed<br> ↳ <b>WEB-UD-Reputation-F</b>: First access to this web domain which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UD-Reputation-A</b>: Abnormal access to this web domain which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UI-Reputation-F</b>: First access to this internet IP address which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UI-Reputation-A</b>: Abnormal access to this IP address which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UD-ALERT-A</b>: Abnormal security alert accessing this malicious domain for user<br> ↳ <b>WEB-UD-ALERT-N</b>: Common security alert on this malicious domain for user<br> ↳ <b>WEB-UT-TOW-A</b>: Abnormal day for this user to access the web via the organization<br> ↳ <b>WEB-UZ-F</b>: First web activity for this user in this zone<br> ↳ <b>WEB-GZ-F</b>: First web activity from this zone for the peer group<br> ↳ <b>WEB-OZ-F</b>: First web activity from this zone for the organization<br> ↳ <b>WEB-ALERT-EXEC</b>: Security violation by Executive in web activity<br> ↳ <b>WEB-URank-F</b>: First web activity to this low ranked web domain<br> ↳ <b>WEB-URank-A</b>: Abnormal web activity to this low ranked web domain<br> ↳ <b>WEB-IPF-Country-F</b>: User has failed trying to directly browse to an IP address belonging to a country never before accessed<br><br><b>T1189 - Drive-by Compromise</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1204.001 - T1204.001</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1566.002 - Phishing: Spearphishing Link</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>WEB-ALERT-EXEC</b>: Security violation by Executive in web activity<br><br><b>T1568.002 - Dynamic Resolution: Domain Generation Algorithms</b><br> ↳ <b>WEB-UD-DGA-A</b>: Abnormal access to this domain which has been identified as DGA<br><br><b>T1102 - Web Service</b><br> ↳ <b>A-WEB-DC</b>: Web activity event on a Domain Controller |  • <b>WEB-URank</b>: Web activity to low ranked domains for the user<br> • <b>WEB-OZ</b>: Network zones where users performs web activity in the organization<br> • <b>WEB-GZ</b>: Network zones where users performs web activity in the peer group<br> • <b>WEB-UZ</b>: Network zones where a user performs web activity from<br> • <b>WEB-UT-TOW</b>: Web activity activity time for user<br> • <b>WEB-UD-ALERT</b>: Top malicious web domain accessed by the user<br> • <b>WEB-UI-Reputation</b>: Top ip addresses flagged by a reputation service that have been accessed by the user<br> • <b>WEB-UD-Reputation</b>: Top web domain flagged by a reputation service that have been accessed by the user<br> • <b>WEB-UD-DGA</b>: Top web domains per user that seem to be DGA generated during web activity<br> • <b>A-NET-OCountry-Outbound</b>: Outbound country per organization<br> • <b>A-NET-HCountry-Outbound</b>: Outbound country per asset<br> • <b>A-WEB-IP</b>: IPs an asset has directly browsed to<br> • <b>A-WEB-HA</b>: Web activity per Host |