Vendor: VMware
==============
### Product: [Carbon Black Cloud Endpoint Standard](../ds_vmware_carbon_black_cloud_endpoint_standard.md)
### Use-Case: [Malware](../../../../UseCases/uc_malware.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  24   |   6    |     16     |      9      |    9    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| app-login    | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Blacklist-Shost</b>: User authentication or login from a known blacklisted IP    |    |
| file-write    | <b>T1547.001 - T1547.001</b><br> ↳ <b>A-FA-StartupFolder-OH-F</b>: A program was added to the startup folder for the first time on this asset<br> ↳ <b>A-FA-StartupFolder-OH-A</b>: Abnormal addition of a program to the startup folder on the asset<br> ↳ <b>FA-StartupFolder-OU-F</b>: A program was added to the startup folder for the first time by the user<br> ↳ <b>FA-StartupFolder-OU-A</b>: Abnormal program addition to the startup folder by the user.<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-Suspicious-LNK</b>: A suspicious .lnk file used, possible ATP activity on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>Suspicious-LNK</b>: A suspicious .lnk file used, possible ATP activity<br><br><b>T1505.003 - Server Software Component: Web Shell</b><br> ↳ <b>A-FW-UMWorkerProcess-FileName-F</b>: First time file creation for Exchange Unified Messaging service UMWorkerProcess.exe<br><br><b>T1003.002 - T1003.002</b><br> ↳ <b>A-ATP-Tool-FGDump</b>: Malicious exe/dll.<br> ↳ <b>A-ATP-Tool-PSTGDump</b>: Malicious pstgdump.exe was run from a temp folder on this asset.    |  • <b>FA-StartupFolder-OU</b>: Users that add programs to the startup folders<br> • <b>A-FW-ProcessName-FileName</b>: File creations for process<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset<br> • <b>A-FA-StartupFolder-OH</b>: Hosts where programs were added to startup folders in the organization |
| network-connection-failed | <b>TA0011 - TA0011</b><br> ↳ <b>A-NET-TI-H-Outbound</b>: Outbound connection to a known malicious host<br> ↳ <b>A-NETF-TI-H-Outbound</b>: Outbound failed connection to a known malicious host    |    |
| process-created-failed    | <b>T1190 - Exploit Public Fasing Application</b><br> ↳ <b>A-EPA-Log4j-String-Command-2</b>: There was an attempt via process creation to exploit the CVE-2021-44228 vulnerability using known keywords on this asset.<br> ↳ <b>EPA-Log4j-String-Command-2</b>: There was an attempt via process creation to exploit the CVE-2021-44228 vulnerability using known keywords.<br><br><b>T1059.005 - T1059.005</b><br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1059.007 - T1059.007</b><br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1218.005 - T1218.005</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1047 - Windows Management Instrumentation</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1127.001 - Trusted Developer Utilities Proxy Execution: MSBuild</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1218.004 - Signed Binary Proxy Execution: InstallUtil</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1218.010 - Signed Binary Proxy Execution: Regsvr32</b><br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>EPA-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user during endpoint activity<br> ↳ <b>EPA-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user during endpoint activity<br><br><b>T1562.004 - Impair Defenses: Disable or Modify System Firewall</b><br> ↳ <b>A-KnownFirewallDisable-Log4j</b>: FireWall disable arguments via command line were detected on this asset.<br><br><b>T1218.001 - Signed Binary Proxy Execution: Compiled HTML File</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset. |  • <b>PC-ParentName-ProcessName</b>: Child processes created by a parent process<br> • <b>EPA-UP-TEMP</b>: Process executable TEMP directories for this user during endpoint activity<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset    |
| security-alert    | <b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>DEF-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user<br> ↳ <b>DEF-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user    |  • <b>AE-UP-TEMP</b>: Process executable TEMP directories for this user during a session<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset    |
| usb-write    | <b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>DEF-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user<br> ↳ <b>DEF-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user    |  • <b>AE-UP-TEMP</b>: Process executable TEMP directories for this user during a session<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset    |