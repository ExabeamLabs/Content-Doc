Vendor: VMware
==============
### Product: [Endpoint Detection and Response](../ds_vmware_endpoint_detection_and_response.md)
### Use-Case: [Compromised Credentials](../../../../UseCases/uc_compromised_credentials.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  105  |   32   |     18     |      5      |    5    |

| Event Type          | Rules    | Models    |
| ---- | ---- | ---- |
| file-read    | <b>T1003.001 - T1003.001</b><br> ↳ <b>A-FA-LSASS</b>: Possible Mimikatz attack on this asset by a user process<br> ↳ <b>FA-LSASS</b>: Possible Mimikatz attack by a user process<br><br><b>T1083 - File and Directory Discovery</b><br> ↳ <b>FA-UA-UI-F</b>: First file activity from ISP<br> ↳ <b>FA-UA-UC-F</b>: First file activity from country for user<br> ↳ <b>FA-UA-UC-A</b>: Abnormal file activity from country for user<br> ↳ <b>FA-UA-GC-F</b>: First file activity from country for group<br> ↳ <b>FA-UA-GC-A</b>: Abnormal file activity from country for group<br> ↳ <b>FA-UA-OC-F</b>: First file activity from country for organization<br> ↳ <b>FA-UA-OC-A</b>: Abnormal file activity from country for organization<br> ↳ <b>FA-UTi</b>: Abnormal user file activity time<br> ↳ <b>FA-UH-F</b>: First file access from asset for user<br> ↳ <b>FA-UH-A</b>: Abnormal file access from asset for user<br> ↳ <b>FA-OZ-F</b>: First file access from network zone for organization<br> ↳ <b>FA-OZ-A</b>: Abnormal file access from network zone for organization<br> ↳ <b>FA-UZ-F</b>: First file access from network zone for user<br> ↳ <b>FA-UZ-A</b>: Abnormal file access from network zone for user<br> ↳ <b>FA-UA-F</b>: First file access activity for user<br> ↳ <b>FA-UA-A</b>: Abnormal file access activity for user<br> ↳ <b>FA-OU-F</b>: First access to source code files for user in the organization<br> ↳ <b>FA-OU-A</b>: Abnormal access to source code files for user in the organization<br> ↳ <b>FA-OG-F</b>: First access to source code files for user in the peer group<br> ↳ <b>FA-OG-A</b>: Abnormal access to source code files for user in the peer group<br> ↳ <b>FA-UD-F</b>: First file server access for user<br> ↳ <b>FA-UD-A</b>: Abnormal file server access for user<br> ↳ <b>FA-GD-F</b>: First file server access for group<br> ↳ <b>FA-GD-A</b>: Abnormal file server access for group<br><br><b>T1003.003 - T1003.003</b><br> ↳ <b>A-NTDS-Access-F</b>: The NTDS database was accessed from a new location on this asset.<br> ↳ <b>A-NTDS-Access-A</b>: The NTDS database was accessed from a non default location on this asset.<br> ↳ <b>A-NTDS-Access</b>: The NTDS database was accessed from a non default location without 'ntds.dit' in the file path on this asset.    |  • <b>FA-GD</b>: File server access per group<br> • <b>FA-UD</b>: File server access per user<br> • <b>FA-OG</b>: Users accessing source code files in the peer group<br> • <b>FA-OU</b>: Users accessing source code files in the organization<br> • <b>FA-UA</b>: File access activities for user<br> • <b>FA-UZ</b>: File accesses from network zone for user<br> • <b>FA-OZ</b>: File accesses from network zone for organization<br> • <b>FA-UH</b>: User file access source host<br> • <b>FA-UTi</b>: File activity time for user<br> • <b>FA-UA-OC</b>: Countries for organization file activities<br> • <b>FA-UA-GC</b>: Countries for peer groups file activities<br> • <b>FA-UA-UC</b>: Countries for user file activity<br> • <b>FA-UA-UI-new</b>: ISP of users during file activity<br> • <b>A-NTDS-Access</b>: Models the amount of accesses to paths that are related to NTDS    |
| file-write          | <b>T1083 - File and Directory Discovery</b><br> ↳ <b>FA-UA-UI-F</b>: First file activity from ISP<br> ↳ <b>FA-UA-UC-F</b>: First file activity from country for user<br> ↳ <b>FA-UA-UC-A</b>: Abnormal file activity from country for user<br> ↳ <b>FA-UA-GC-F</b>: First file activity from country for group<br> ↳ <b>FA-UA-GC-A</b>: Abnormal file activity from country for group<br> ↳ <b>FA-UA-OC-F</b>: First file activity from country for organization<br> ↳ <b>FA-UA-OC-A</b>: Abnormal file activity from country for organization<br> ↳ <b>FA-UTi</b>: Abnormal user file activity time<br> ↳ <b>FA-UH-F</b>: First file access from asset for user<br> ↳ <b>FA-UH-A</b>: Abnormal file access from asset for user<br> ↳ <b>FA-OZ-F</b>: First file access from network zone for organization<br> ↳ <b>FA-OZ-A</b>: Abnormal file access from network zone for organization<br> ↳ <b>FA-UZ-F</b>: First file access from network zone for user<br> ↳ <b>FA-UZ-A</b>: Abnormal file access from network zone for user<br> ↳ <b>FA-UA-F</b>: First file access activity for user<br> ↳ <b>FA-UA-A</b>: Abnormal file access activity for user<br> ↳ <b>FA-OU-F</b>: First access to source code files for user in the organization<br> ↳ <b>FA-OU-A</b>: Abnormal access to source code files for user in the organization<br> ↳ <b>FA-OG-F</b>: First access to source code files for user in the peer group<br> ↳ <b>FA-OG-A</b>: Abnormal access to source code files for user in the peer group<br> ↳ <b>FA-UD-F</b>: First file server access for user<br> ↳ <b>FA-UD-A</b>: Abnormal file server access for user<br> ↳ <b>FA-GD-F</b>: First file server access for group<br> ↳ <b>FA-GD-A</b>: Abnormal file server access for group<br><br><b>T1003.003 - T1003.003</b><br> ↳ <b>A-NTDS-Access-F</b>: The NTDS database was accessed from a new location on this asset.<br> ↳ <b>A-NTDS-Access-A</b>: The NTDS database was accessed from a non default location on this asset.<br> ↳ <b>A-NTDS-Access</b>: The NTDS database was accessed from a non default location without 'ntds.dit' in the file path on this asset.<br> ↳ <b>A-NTDS-Shadow-Copy1</b>: The NTDS database changed location to a shadowcopy using 'ntds.dit' and 'harddiskvolumeshadowcopy' in the file path on this asset.<br> ↳ <b>A-NTDS-Shadow-Copy2</b>: The NTDS database changed location to a shadowcopy using 'harddiskvolumeshadowcopy' in the file path on this asset.<br><br><b>T1003.002 - T1003.002</b><br> ↳ <b>A-ATP-Tool-FGDump</b>: Malicious exe/dll.<br> ↳ <b>A-ATP-Tool-PSTGDump</b>: Malicious pstgdump.exe was run from a temp folder on this asset.    |  • <b>FA-GD</b>: File server access per group<br> • <b>FA-UD</b>: File server access per user<br> • <b>FA-OG</b>: Users accessing source code files in the peer group<br> • <b>FA-OU</b>: Users accessing source code files in the organization<br> • <b>FA-UA</b>: File access activities for user<br> • <b>FA-UZ</b>: File accesses from network zone for user<br> • <b>FA-OZ</b>: File accesses from network zone for organization<br> • <b>FA-UH</b>: User file access source host<br> • <b>FA-UTi</b>: File activity time for user<br> • <b>FA-UA-OC</b>: Countries for organization file activities<br> • <b>FA-UA-GC</b>: Countries for peer groups file activities<br> • <b>FA-UA-UC</b>: Countries for user file activity<br> • <b>FA-UA-UI-new</b>: ISP of users during file activity<br> • <b>A-NTDS-Access</b>: Models the amount of accesses to paths that are related to NTDS    |
| process-created     | <b>T1003.002 - T1003.002</b><br> ↳ <b>A-GRAB-REG-HIVES</b>: Grabbing Sensitive Hives via Reg Utility on this asset<br> ↳ <b>GRAB-REG-HIVES</b>: Grabbing Sensitive Hives via Reg Utility<br> ↳ <b>ATP-PWDump</b>: Malicious exe was run which is a part of credential dumping tool<br><br><b>T1003.001 - T1003.001</b><br> ↳ <b>A-CreateMiniDump-Hacktool</b>: CreateMiniDump Hacktool detected on this asset.<br> ↳ <b>A-LSASS-Mem-Dump</b>: LSASS Memory Dumping detected on this asset<br> ↳ <b>A-Proc-Dump-Comsvcs</b>: Process Dump via Rundll32 and Comsvcs.dll detected on this asset<br> ↳ <b>A-Sus-Procdump</b>: Suspicious Use of Procdump on this asset.<br> ↳ <b>A-Procdump-Comsvcs-DLL</b>: Process Dump via Comsvcs DLL on this asset<br> ↳ <b>A-PC-Rundll-LsassDump</b>: Rundll32 was run with minidump via commandline on this asset.<br> ↳ <b>A-PC-Procdump-LsassDump</b>: Procdump was executed with lsass dump command line parameters on this asset.<br> ↳ <b>CreateMiniDump-Hacktool</b>: CreateMiniDump Hacktool<br> ↳ <b>LSASS-Mem-Dump</b>: LSASS Memory Dumping<br> ↳ <b>Proc-Dump-Comsvcs</b>: Process Dump via Rundll32 and Comsvcs.dll<br> ↳ <b>Sus-Procdump</b>: Suspicious Use of Procdump<br> ↳ <b>Procdump-Comsvcs-DLL</b>: Process Dump via Comsvcs DLL<br> ↳ <b>PC-Rundll-LsassDump</b>: Rundll32 was run with minidump via commandline<br> ↳ <b>PC-Procdump-LsassDump</b>: Procdump was executed with lsass dump command line parameters.<br><br><b>T1218.011 - Signed Binary Proxy Execution: Rundll32</b><br> ↳ <b>A-Procdump-Comsvcs-DLL</b>: Process Dump via Comsvcs DLL on this asset<br> ↳ <b>A-PC-Rundll-LsassDump</b>: Rundll32 was run with minidump via commandline on this asset.<br> ↳ <b>Procdump-Comsvcs-DLL</b>: Process Dump via Comsvcs DLL<br> ↳ <b>PC-Rundll-LsassDump</b>: Rundll32 was run with minidump via commandline<br><br><b>T1040 - Network Sniffing</b><br> ↳ <b>A-NSniff-Cred</b>: Potential network sniffing was observed on this asset.<br> ↳ <b>A-EPA-SNIFF</b>: Network sniffing tool has been found running on this asset<br> ↳ <b>A-EPA-OH-SNIFF-F</b>: First time this asset has had an execution of a network sniffing tool<br> ↳ <b>A-EPA-OH-SNIFF-A</b>: Abnormal asset running network sniffing tool<br> ↳ <b>A-EPA-OZ-SNIFF-F</b>: First zone on which network sniffing tool was run<br> ↳ <b>A-EPA-OZ-SNIFF-A</b>: Abnormal zone on which network sniffing tool was run<br> ↳ <b>EPA-SNIFF</b>: Network sniffing tool has been run by this user<br> ↳ <b>EPA-OU-SNIFF-F</b>: First time this user has run a network sniffing tool<br> ↳ <b>EPA-OU-SNIFF-A</b>: Abnormal user has run a network sniffing tool<br> ↳ <b>EPA-OG-SNIFF-F</b>: First time this peer group has run a network sniffing tool<br> ↳ <b>EPA-OG-SNIFF-A</b>: Abnormal peer group running a network sniffing tool<br> ↳ <b>EPA-OH-SNIFF-F</b>: First time this host has run a network sniffing tool<br> ↳ <b>EPA-OH-SNIFF-A</b>: Abnormal host running a network sniffing tool<br> ↳ <b>EPA-OZ-SNIFF-F</b>: First time this network zone on which a networking sniffing tool run.<br> ↳ <b>EPA-OZ-SNIFF-A</b>: Abnormal network zone on which network sniffing tool was run<br> ↳ <b>NSniff-Cred</b>: Potential network sniffing was observed<br><br><b>T1003 - OS Credential Dumping</b><br> ↳ <b>A-CP-Sensitive-Files</b>: Copying sensitive files with credential data on this asset<br> ↳ <b>A-ShadowCP-SymLink</b>: Shadow Copies Access via Symlink on this asset<br> ↳ <b>A-ShadowCP-OSUtilities</b>: Shadow Copies Creation Using Operating Systems Utilities on this asset<br> ↳ <b>Mimikatz-process</b>: A highly dangerous attacker tool, Mimikatz, has been used<br> ↳ <b>CP-Sensitive-Files</b>: Copying sensitive files with credential data<br> ↳ <b>ShadowCP-SymLink</b>: Shadow Copies Access via Symlink<br> ↳ <b>ShadowCP-OSUtilities</b>: Shadow Copies Creation Using Operating Systems Utilities<br> ↳ <b>Cmdkey-Cred-Recon</b>: Cmdkey Cached Credentials Recon<br><br><b>T1003.003 - T1003.003</b><br> ↳ <b>AD-Diagnostic-Tool</b>: Invocation of Active Directory Diagnostic Tool (ntdsutil.exe)<br><br><b>T1555 - Credentials from Password Stores</b><br> ↳ <b>A-SecX-Tool-Exec</b>: SecurityXploded Tool execution detected on this asset<br> ↳ <b>SecX-Tool-Exec</b>: SecurityXploded Tool execution detected<br><br><b>T1016 - System Network Configuration Discovery</b><br> ↳ <b>WINCMD-Route</b>: 'Route' program used<br> ↳ <b>WINCMD-Netsh</b>: 'Netsh' program used<br><br><b>TA0002 - TA0002</b><br> ↳ <b>EPA-UH-Pen-F</b>: Known pentest tool used<br><br><b>T1003.005 - T1003.005</b><br> ↳ <b>A-Cmdkey-Cred-Recon</b>: Cmdkey Cached Credentials Recon on this asset |  • <b>EPA-OZ-SNIFF</b>: Network Zones on which network sniffing tools are run<br> • <b>EPA-OH-SNIFF</b>: Hosts that have been found to be running network sniffing tools<br> • <b>EPA-OG-SNIFF</b>: Peer groups that are running network sniffing tools<br> • <b>EPA-OU-SNIFF</b>: Users that are running network sniffing tools<br> • <b>EPA-UH-Pen</b>: Malicious tools used by user    |
| web-activity-denied | <b>T1071.001 - Application Layer Protocol: Web Protocols</b><br> ↳ <b>A-WEB-HA-F</b>: First web activity event on asset<br> ↳ <b>A-WEB-DC</b>: Web activity event on a Domain Controller<br> ↳ <b>A-WEBF-IP-Country-F</b>: Asset failed to directly connect to an IP address in a country never before accessed<br> ↳ <b>A-WEBF-IP-Country-A</b>: Abnormal direct access to an IP address by the asset belonging to an abnormal country for the asset to access has failed<br> ↳ <b>A-NETF-HCountry-Outbound-WEB-F</b>: First failed web browsing connection to this country from asset<br> ↳ <b>A-NETF-HCountry-Outbound-WEB-A</b>: Web browsing connection to abnormal country for asset has failed<br> ↳ <b>A-NETF-OCountry-Outbound-WEB-F</b>: First failed web browsing connection to this country from organization<br> ↳ <b>A-NETF-OCountry-Outbound-WEB-A</b>: Web browsing connection to abnormal country for the organization has failed<br> ↳ <b>WEB-UD-Reputation-F</b>: First access to this web domain which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UD-Reputation-A</b>: Abnormal access to this web domain which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UI-Reputation-F</b>: First access to this internet IP address which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UI-Reputation-A</b>: Abnormal access to this IP address which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UD-ALERT-A</b>: Abnormal security alert accessing this malicious domain for user<br> ↳ <b>WEB-UD-ALERT-N</b>: Common security alert on this malicious domain for user<br> ↳ <b>WEB-UT-TOW-A</b>: Abnormal day for this user to access the web via the organization<br> ↳ <b>WEB-UZ-F</b>: First web activity for this user in this zone<br> ↳ <b>WEB-GZ-F</b>: First web activity from this zone for the peer group<br> ↳ <b>WEB-OZ-F</b>: First web activity from this zone for the organization<br> ↳ <b>WEB-ALERT-EXEC</b>: Security violation by Executive in web activity<br> ↳ <b>WEB-URank-F</b>: First web activity to this low ranked web domain<br> ↳ <b>WEB-URank-A</b>: Abnormal web activity to this low ranked web domain<br> ↳ <b>WEB-IPF-Country-F</b>: User has failed trying to directly browse to an IP address belonging to a country never before accessed<br><br><b>T1189 - Drive-by Compromise</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1204.001 - T1204.001</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1566.002 - Phishing: Spearphishing Link</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>WEB-ALERT-EXEC</b>: Security violation by Executive in web activity<br><br><b>T1568.002 - Dynamic Resolution: Domain Generation Algorithms</b><br> ↳ <b>WEB-UD-DGA-A</b>: Abnormal access to this domain which has been identified as DGA<br><br><b>T1102 - Web Service</b><br> ↳ <b>A-WEB-DC</b>: Web activity event on a Domain Controller    |  • <b>WEB-URank</b>: Web activity to low ranked domains for the user<br> • <b>WEB-OZ</b>: Network zones where users performs web activity in the organization<br> • <b>WEB-GZ</b>: Network zones where users performs web activity in the peer group<br> • <b>WEB-UZ</b>: Network zones where a user performs web activity from<br> • <b>WEB-UT-TOW</b>: Web activity activity time for user<br> • <b>WEB-UD-ALERT</b>: Top malicious web domain accessed by the user<br> • <b>WEB-UI-Reputation</b>: Top ip addresses flagged by a reputation service that have been accessed by the user<br> • <b>WEB-UD-Reputation</b>: Top web domain flagged by a reputation service that have been accessed by the user<br> • <b>WEB-UD-DGA</b>: Top web domains per user that seem to be DGA generated during web activity<br> • <b>A-NET-OCountry-Outbound</b>: Outbound country per organization<br> • <b>A-NET-HCountry-Outbound</b>: Outbound country per asset<br> • <b>A-WEB-IP</b>: IPs an asset has directly browsed to<br> • <b>A-WEB-HA</b>: Web activity per Host |