Vendor: F5
==========
### Product: [F5 Advanced Web Application Firewall (WAF)](../ds_f5_f5_advanced_web_application_firewall_(waf).md)
### Use-Case: [Lateral Movement](../../../../UseCases/uc_lateral_movement.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  81   |   19   |     14     |      6      |    6    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| network-connection-successful | <b>T1071 - Application Layer Protocol</b><br> ↳ <b>A-NET-ZdH-Inbound-A</b>: Abnormal inbound connection to host for the zone.<br><br><b>TA0011 - TA0011</b><br> ↳ <b>A-NET-HdPort-Inbound-F</b>: First inbound connection on port for asset<br> ↳ <b>A-NET-HdPort-Inbound-A</b>: Abnormal inbound network connection to this port for asset<br> ↳ <b>A-NET-ZdPort-Inbound-F</b>: First inbound connection on port for zone<br> ↳ <b>A-NET-ZdPort-Inbound-A</b>: Abnormal inbound connection on port for zone<br> ↳ <b>A-NET-HCountry-Inbound-F</b>: First inbound connection from this country for asset<br> ↳ <b>A-NET-HCountry-Inbound-A</b>: Abnormal connection from this country for asset<br> ↳ <b>A-NET-ZCountry-Inbound-F</b>: First inbound connection from this country for zone<br> ↳ <b>A-NET-ZCountry-Inbound-A</b>: Abnormal connection from this country for the zone<br> ↳ <b>A-NET-OCountry-Inbound-F</b>: First inbound connection from this country for organization<br> ↳ <b>A-NET-OCountry-Inbound-A</b>: Abnormal connection from this country for the organization<br> ↳ <b>A-NET-HCountry-Outbound-F</b>: First outbound connection to this country from asset<br> ↳ <b>A-NET-HCountry-Outbound-A</b>: Abnormal outbound communication country for asset<br> ↳ <b>A-NET-ZCountry-Outbound-F</b>: First outbound connection to this country from zone<br> ↳ <b>A-NET-ZCountry-Outbound-A</b>: Abnormal outbound connection country for the zone<br> ↳ <b>A-NET-OCountry-Outbound-F</b>: First outbound connection to this country from organization<br> ↳ <b>A-NET-OCountry-Outbound-A</b>: Abnormal outbound connection country for the organization<br> ↳ <b>A-NET-TI-H-Outbound</b>: Outbound connection to a known malicious host<br> ↳ <b>A-NET-TI-IP-Inbound</b>: Inbound connection from a known malicious IP<br> ↳ <b>A-NET-TI-H-Inbound</b>: Inbound connection from a known malicious host<br> ↳ <b>A-NET-OdPort-Inbound-F</b>: First inbound traffic on previously unused port for the organization.<br> ↳ <b>A-NET-OdPort-Inbound-A</b>: Abnormal inbound traffic on previously unused port for the organization.<br> ↳ <b>A-NET-OsH-Outbound-A</b>: Abnormal outbound connection for asset in the organization<br> ↳ <b>A-NET-ZsH-Outbound-F</b>: First outbound connection for asset for zone<br> ↳ <b>A-NET-ZsH-Outbound-A</b>: Abnormal outbound connection for asset for zone<br> ↳ <b>A-NET-HsH-Outbound-F</b>: First outbound connection for asset<br> ↳ <b>A-NET-HsH-Outbound-A</b>: Abnormal outbound connection for asset<br> ↳ <b>A-NET-OsZ-Outbound-F</b>: First outbound connection from zone for organization<br> ↳ <b>A-NET-OsZ-Outbound-A</b>: Abnormal outbound connection from zone for organization<br> ↳ <b>A-NET-ZsZ-Outbound-F</b>: First outbound connection from zone<br> ↳ <b>A-NET-ZsZ-Outbound-A</b>: Abnormal outbound connection from zone for asset<br> ↳ <b>A-NET-HsZ-Outbound-F</b>: First outbound connection from zone for asset<br> ↳ <b>A-NET-HsZ-Outbound-A</b>: Abnormal outbound connection from zone<br> ↳ <b>A-NET-OdH-Inbound-F</b>: First inbound connection to host for the organization.<br> ↳ <b>A-NET-OdH-Inbound-A</b>: Abnormal inbound connection to host for the organization.<br> ↳ <b>A-NET-ZdH-Inbound-F</b>: First inbound connection to host for the zone.<br><br><b>TA0010 - TA0010</b><br> ↳ <b>A-NET-HCountry-Outbound-F</b>: First outbound connection to this country from asset<br> ↳ <b>A-NET-HCountry-Outbound-A</b>: Abnormal outbound communication country for asset<br> ↳ <b>A-NET-ZCountry-Outbound-F</b>: First outbound connection to this country from zone<br> ↳ <b>A-NET-ZCountry-Outbound-A</b>: Abnormal outbound connection country for the zone<br> ↳ <b>A-NET-OCountry-Outbound-F</b>: First outbound connection to this country from organization<br> ↳ <b>A-NET-OCountry-Outbound-A</b>: Abnormal outbound connection country for the organization<br> ↳ <b>A-NET-OsH-Outbound-A</b>: Abnormal outbound connection for asset in the organization<br> ↳ <b>A-NET-ZsH-Outbound-F</b>: First outbound connection for asset for zone<br> ↳ <b>A-NET-ZsH-Outbound-A</b>: Abnormal outbound connection for asset for zone<br> ↳ <b>A-NET-HsH-Outbound-F</b>: First outbound connection for asset<br> ↳ <b>A-NET-HsH-Outbound-A</b>: Abnormal outbound connection for asset<br> ↳ <b>A-NET-OsZ-Outbound-F</b>: First outbound connection from zone for organization<br> ↳ <b>A-NET-OsZ-Outbound-A</b>: Abnormal outbound connection from zone for organization<br> ↳ <b>A-NET-ZsZ-Outbound-F</b>: First outbound connection from zone<br> ↳ <b>A-NET-ZsZ-Outbound-A</b>: Abnormal outbound connection from zone for asset<br> ↳ <b>A-NET-HsZ-Outbound-F</b>: First outbound connection from zone for asset<br> ↳ <b>A-NET-HsZ-Outbound-A</b>: Abnormal outbound connection from zone<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>A-NET-TOR-Outbound</b>: Outbound connection to a known TOR IP<br> ↳ <b>A-NET-TOR-Inbound</b>: Inbound connection from a known TOR IP<br><br><b>T1190 - Exploit Public Fasing Application</b><br> ↳ <b>A-NET-HdPort-Inbound-F</b>: First inbound connection on port for asset<br> ↳ <b>A-NET-HdPort-Inbound-A</b>: Abnormal inbound network connection to this port for asset<br> ↳ <b>A-NET-ZdPort-Inbound-F</b>: First inbound connection on port for zone<br> ↳ <b>A-NET-ZdPort-Inbound-A</b>: Abnormal inbound connection on port for zone<br> ↳ <b>A-NET-HCountry-Inbound-F</b>: First inbound connection from this country for asset<br> ↳ <b>A-NET-HCountry-Inbound-A</b>: Abnormal connection from this country for asset<br> ↳ <b>A-NET-ZCountry-Inbound-F</b>: First inbound connection from this country for zone<br> ↳ <b>A-NET-ZCountry-Inbound-A</b>: Abnormal connection from this country for the zone<br> ↳ <b>A-NET-OCountry-Inbound-F</b>: First inbound connection from this country for organization<br> ↳ <b>A-NET-OCountry-Inbound-A</b>: Abnormal connection from this country for the organization |  • <b>A-NET-ZdH-Inbound</b>: Hosts receiving inbound communications in the zone<br> • <b>A-NET-OdH-Inbound</b>: Hosts receiving inbound communications in the organization<br> • <b>A-NET-HsZ-Outbound</b>: Outbound communicating zones for the asset<br> • <b>A-NET-ZsZ-Outbound</b>: Outbound communicating zones<br> • <b>A-NET-OsZ-Outbound</b>: Outbound communicating zones in the organization<br> • <b>A-NET-HsH-Outbound</b>: Outbound communicating hosts for the asset<br> • <b>A-NET-ZsH-Outbound</b>: Outbound communicating hosts in the zone<br> • <b>A-NET-OsH-Outbound</b>: Outbound communicating hosts<br> • <b>A-NET-OdPort-Inbound</b>: Inbound destination ports per organization<br> • <b>A-NET-OCountry-Outbound</b>: Outbound country per organization<br> • <b>A-NET-ZCountry-Outbound</b>: Outbound country per zone<br> • <b>A-NET-HCountry-Outbound</b>: Outbound country per asset<br> • <b>A-NET-OCountry-Inbound</b>: Origination country per organization<br> • <b>A-NET-ZCountry-Inbound</b>: Origination country per zone<br> • <b>A-NET-HCountry-Inbound</b>: Inbound country per asset<br> • <b>A-NET-ZdPort-Inbound</b>: Inbound destination ports per zone<br> • <b>A-NET-HdPort-Inbound</b>: Inbound destination ports per asset |
| process-created    | <b>T1021.003 - T1021.003</b><br> ↳ <b>A-Impacket-Lateral-Detection</b>: Activity related to Impacket framework using wmiexec, dcomexe, or smbexec processes via command line have been found on this asset.<br> ↳ <b>A-PC-ParentName-ProcessName-DCOM-F</b>: First time child process creation for DCOM associated process on this asset.<br> ↳ <b>A-PC-ParentName-ProcessName-DCOM-A</b>: Abnormal child process creation for DCOM associated process on the asset.<br> ↳ <b>A-DCOMActivation-Known</b>: Remote DCOM activation under DcomLaunch service on this asset.<br> ↳ <b>Impacket-Lateral-Detection</b>: Activity related to Impacket framework using wmiexec, dcomexe, or smbexec processes via command line have been found.<br> ↳ <b>PC-ParentName-ProcessName-DCOM-F</b>: First time child process creation for DCOM associated process<br> ↳ <b>PC-ParentName-ProcessName-DCOM-A</b>: Abnormal child process creation for DCOM associated process.<br> ↳ <b>DCOMActivation-Known</b>: Remote DCOM activation under DcomLaunch service<br><br><b>T1210 - Exploitation of Remote Services</b><br> ↳ <b>A-Terminal-Svc-Proc-Spawn</b>: Process spawned by the terminal service server on this asset.<br> ↳ <b>Terminal-Svc-Proc-Spawn</b>: Process spawned by the terminal service server<br><br><b>T1090 - Proxy</b><br> ↳ <b>A-Netsh-Port-Fwd</b>: Netsh commands were used to configure port forwarding on this asset.<br> ↳ <b>Netsh-Port-Fwd</b>: Netsh commands were used to configure port forwarding.<br><br><b>T1021.001 - Remote Services: Remote Desktop Protocol</b><br> ↳ <b>A-Suspicious-RDP-TSCON</b>: Suspicious usage of RDP using tscon.exe on this asset<br> ↳ <b>A-Netsh-RDP-Port-Fwd</b>: Netsh commands used to configure port forwarding for port 3389, used for RDP, were detected on this asset.<br> ↳ <b>Suspicious-RDP-TSCON</b>: Suspicious usage of RDP using tscon.exe<br> ↳ <b>Netsh-RDP-Port-Fwd</b>: Netsh commands used to configure port forwarding for port 3389, used for RDP, were detected.<br><br><b>T1047 - Windows Management Instrumentation</b><br> ↳ <b>A-Impacket-Lateral-Detection</b>: Activity related to Impacket framework using wmiexec, dcomexe, or smbexec processes via command line have been found on this asset.<br> ↳ <b>Impacket-Lateral-Detection</b>: Activity related to Impacket framework using wmiexec, dcomexe, or smbexec processes via command line have been found.<br><br><b>T1021.006 - T1021.006</b><br> ↳ <b>A-Remote-Powershell-Session</b>: Remote Powershell session was detected by monitoring for wsmprovhost as a parent or child process on this asset.<br> ↳ <b>Remote-Powershell-Session</b>: Remote Powershell session was detected by monitoring for wsmprovhost as a parent or child process.<br><br><b>T1059.001 - Command and Scripting Interperter: PowerShell</b><br> ↳ <b>A-Remote-Powershell-Session</b>: Remote Powershell session was detected by monitoring for wsmprovhost as a parent or child process on this asset.<br> ↳ <b>Remote-Powershell-Session</b>: Remote Powershell session was detected by monitoring for wsmprovhost as a parent or child process.<br><br><b>T1219 - Remote Access Software</b><br> ↳ <b>A-EPA-RAT-TSS</b>: TeamViewer remote desktop access service started on this asset<br> ↳ <b>A-EPA-RAT-SSI</b>: Splashtop remote desktop access service installed on this asset<br> ↳ <b>A-EPA-RAT-TI</b>: TeamViewer remote desktop access agent installed on this asset<br> ↳ <b>A-EPA-RAT-SSS</b>: Splashtop remote desktop access service started on this asset<br> ↳ <b>A-EPA-RAT-SI</b>: Splashtop remote desktop access agent installed on this asset<br> ↳ <b>A-EPA-RAT-GSS</b>: GoToMyPC remote desktop access service started on this asset<br> ↳ <b>A-EPA-RAT-GSI</b>: GoToMyPC remote desktop access service installed on this asset<br> ↳ <b>A-EPA-RAT-TSI</b>: TeamViewer remote desktop access service installed on this asset<br> ↳ <b>A-EPA-RAT-LSS</b>: LogMeIn remote desktop access service started on this asset<br> ↳ <b>A-EPA-RAT-LSI</b>: LogMeIn remote desktop access service installed on this asset<br> ↳ <b>A-EPA-RAT-LI</b>: LogMeIn remote desktop access agent installed on this asset<br> ↳ <b>A-EPA-RAT-GI</b>: GoToMyPC remote desktop access agent installed on this asset<br> ↳ <b>A-TSCON-LocalSystem</b>: Tscon.exe was executed as Local System on this asset<br> ↳ <b>EPA-RAT-GSI</b>: GoToMyPC remote desktop access service installed by this user<br> ↳ <b>EPA-RAT-LSS</b>: LogMeIn remote desktop access service started by this user<br> ↳ <b>EPA-RAT-LI</b>: LogMeIn remote desktop access agent installed by this user<br> ↳ <b>EPA-RAT-SSI</b>: Splashtop remote desktop access service installed by this user<br> ↳ <b>EPA-RAT-SI</b>: Splashtop remote desktop access agent installed by this user<br> ↳ <b>EPA-RAT-TSI</b>: TeamViewer remote desktop access service installed by this user<br> ↳ <b>EPA-RAT-GI</b>: GoToMyPC remote desktop access agent installed by this user<br> ↳ <b>EPA-RAT-TI</b>: TeamViewer remote desktop access agent installed by this user<br> ↳ <b>EPA-RAT-GSS</b>: GoToMyPC remote desktop access service started by this user<br> ↳ <b>EPA-RAT-TSS</b>: TeamViewer remote desktop access service started by this user<br> ↳ <b>EPA-RAT-SSS</b>: Splashtop remote desktop access service started by this user<br> ↳ <b>EPA-RAT-LSI</b>: LogMeIn remote desktop access service installed by this user<br><br><b>T1563.002 - T1563.002</b><br> ↳ <b>A-TSCON-LocalSystem</b>: Tscon.exe was executed as Local System on this asset    |  • <b>PC-ParentName-ProcessName</b>: Child processes created by a parent process<br> • <b>A-PC-ParentName-ProcessName</b>: Processes for parent parent processes.    |