Vendor: Okta
============
### Product: [Okta Adaptive MFA](../ds_okta_okta_adaptive_mfa.md)
### Use-Case: [Lateral Movement](../../../../UseCases/uc_lateral_movement.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  63   |   22   |     15     |     13      |   13    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| app-activity          | <b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost</b>: User authentication or login from a known TOR IP    |    |
| app-activity-failed   | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP    |    |
| app-login    | <b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost</b>: User authentication or login from a known TOR IP    |    |
| authentication-failed | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP    |    |
| failed-app-login      | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP    |    |
| failed-logon          | <b>T1550.002 - Use Alternate Authentication Material: Pass the Hash</b><br> ↳ <b>A-PTH-ALERT-sH-Failed</b>: Failed pass the hash attack with keylength of 0 in NTLM event and a 'null' sid on this source host.<br> ↳ <b>FAIL-PTH-ALERT-sH</b>: Possible unsuccessful pass the hash attack from the source<br> ↳ <b>FAIL-PTH-ALERT-dH</b>: Possible unsuccessful pass the hash attack by the user<br> ↳ <b>PTH-ALERT-sH-Failed</b>: Failed pass the hash attack with keylength of 0 in NTLM event and a 'null' sid.<br><br><b>T1021.001 - Remote Services: Remote Desktop Protocol</b><br> ↳ <b>RDP-Brute-Force</b>: Abnormal number of RDP failed logons for this user<br><br><b>T1110 - Brute Force</b><br> ↳ <b>A-FL-MULTI-USERS-S</b>: Multiple users failed to login (S)<br> ↳ <b>A-FL-MULTI-USERS-L</b>: Multiple users failed to login (L)<br> ↳ <b>A-FL-MULTI-USERS-M</b>: Multiple users failed to login (M)<br> ↳ <b>A-FL-MULTI-DEST-S</b>: Failed logins to multiple destinations from host (S)<br> ↳ <b>A-FL-MULTI-DEST-M</b>: Failed logins to multiple destinations from host (M)<br> ↳ <b>RDP-Brute-Force</b>: Abnormal number of RDP failed logons for this user<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP<br><br><b>T1550.003 - Use Alternate Authentication Material: Pass the Ticket</b><br> ↳ <b>KL-TfG</b>: Rare Kerberos ticket failure code<br> ↳ <b>KL-Tf-fail</b>: Failed logon due to a malformed authentication ticket<br><br><b>T1558 - Steal or Forge Kerberos Tickets</b><br> ↳ <b>KL-TfG</b>: Rare Kerberos ticket failure code<br> ↳ <b>KL-Tf-fail</b>: Failed logon due to a malformed authentication ticket<br><br><b>T1110.003 - T1110.003</b><br> ↳ <b>A-FL-MULTI-USERS-SRC</b>: The same host failed to login to multiple users    |  • <b>AE-OHr</b>: Random hostnames    |
| nac-logon    | <b>T1078 - Valid Accounts</b><br> ↳ <b>NAC-UL-F</b>: First network location for user<br> ↳ <b>NAC-UL-A</b>: Abnormal network location for user<br> ↳ <b>NAC-UM-F</b>: First MAC for user<br> ↳ <b>NAC-UM-A</b>: Abnormal MAC for user<br><br><b>T1021 - Remote Services</b><br> ↳ <b>NAC-UL-F</b>: First network location for user<br> ↳ <b>NAC-UL-A</b>: Abnormal network location for user    |  • <b>NAC-UM</b>: MAC addresses for user<br> • <b>NAC-UL</b>: Network locations for user    |
| process-network       | <b>TA0010 - TA0010</b><br> ↳ <b>A-NET-HCountry-Outbound-F</b>: First outbound connection to this country from asset<br> ↳ <b>A-NET-HCountry-Outbound-A</b>: Abnormal outbound communication country for asset<br> ↳ <b>A-NET-ZCountry-Outbound-F</b>: First outbound connection to this country from zone<br> ↳ <b>A-NET-ZCountry-Outbound-A</b>: Abnormal outbound connection country for the zone<br> ↳ <b>A-NET-OCountry-Outbound-F</b>: First outbound connection to this country from organization<br> ↳ <b>A-NET-OCountry-Outbound-A</b>: Abnormal outbound connection country for the organization<br> ↳ <b>A-NET-OsH-Outbound-A</b>: Abnormal outbound connection for asset in the organization<br> ↳ <b>A-NET-ZsH-Outbound-F</b>: First outbound connection for asset for zone<br> ↳ <b>A-NET-ZsH-Outbound-A</b>: Abnormal outbound connection for asset for zone<br> ↳ <b>A-NET-HsH-Outbound-F</b>: First outbound connection for asset<br> ↳ <b>A-NET-HsH-Outbound-A</b>: Abnormal outbound connection for asset<br> ↳ <b>A-NET-OsZ-Outbound-F</b>: First outbound connection from zone for organization<br> ↳ <b>A-NET-OsZ-Outbound-A</b>: Abnormal outbound connection from zone for organization<br> ↳ <b>A-NET-ZsZ-Outbound-F</b>: First outbound connection from zone<br> ↳ <b>A-NET-ZsZ-Outbound-A</b>: Abnormal outbound connection from zone for asset<br> ↳ <b>A-NET-HsZ-Outbound-F</b>: First outbound connection from zone for asset<br> ↳ <b>A-NET-HsZ-Outbound-A</b>: Abnormal outbound connection from zone<br> ↳ <b>EPA-PT-F</b>: Process accessed this internet IP address for the first time<br><br><b>TA0011 - TA0011</b><br> ↳ <b>A-NET-HdPort-Inbound-F</b>: First inbound connection on port for asset<br> ↳ <b>A-NET-HdPort-Inbound-A</b>: Abnormal inbound network connection to this port for asset<br> ↳ <b>A-NET-ZdPort-Inbound-F</b>: First inbound connection on port for zone<br> ↳ <b>A-NET-ZdPort-Inbound-A</b>: Abnormal inbound connection on port for zone<br> ↳ <b>A-NET-HCountry-Inbound-F</b>: First inbound connection from this country for asset<br> ↳ <b>A-NET-HCountry-Inbound-A</b>: Abnormal connection from this country for asset<br> ↳ <b>A-NET-ZCountry-Inbound-F</b>: First inbound connection from this country for zone<br> ↳ <b>A-NET-ZCountry-Inbound-A</b>: Abnormal connection from this country for the zone<br> ↳ <b>A-NET-OCountry-Inbound-F</b>: First inbound connection from this country for organization<br> ↳ <b>A-NET-OCountry-Inbound-A</b>: Abnormal connection from this country for the organization<br> ↳ <b>A-NET-HCountry-Outbound-F</b>: First outbound connection to this country from asset<br> ↳ <b>A-NET-HCountry-Outbound-A</b>: Abnormal outbound communication country for asset<br> ↳ <b>A-NET-ZCountry-Outbound-F</b>: First outbound connection to this country from zone<br> ↳ <b>A-NET-ZCountry-Outbound-A</b>: Abnormal outbound connection country for the zone<br> ↳ <b>A-NET-OCountry-Outbound-F</b>: First outbound connection to this country from organization<br> ↳ <b>A-NET-OCountry-Outbound-A</b>: Abnormal outbound connection country for the organization<br> ↳ <b>A-NET-TI-H-Outbound</b>: Outbound connection to a known malicious host<br> ↳ <b>A-NET-TI-IP-Inbound</b>: Inbound connection from a known malicious IP<br> ↳ <b>A-NET-TI-H-Inbound</b>: Inbound connection from a known malicious host<br> ↳ <b>A-NET-OdPort-Inbound-F</b>: First inbound traffic on previously unused port for the organization.<br> ↳ <b>A-NET-OdPort-Inbound-A</b>: Abnormal inbound traffic on previously unused port for the organization.<br> ↳ <b>A-NET-OsH-Outbound-A</b>: Abnormal outbound connection for asset in the organization<br> ↳ <b>A-NET-ZsH-Outbound-F</b>: First outbound connection for asset for zone<br> ↳ <b>A-NET-ZsH-Outbound-A</b>: Abnormal outbound connection for asset for zone<br> ↳ <b>A-NET-HsH-Outbound-F</b>: First outbound connection for asset<br> ↳ <b>A-NET-HsH-Outbound-A</b>: Abnormal outbound connection for asset<br> ↳ <b>A-NET-OsZ-Outbound-F</b>: First outbound connection from zone for organization<br> ↳ <b>A-NET-OsZ-Outbound-A</b>: Abnormal outbound connection from zone for organization<br> ↳ <b>A-NET-ZsZ-Outbound-F</b>: First outbound connection from zone<br> ↳ <b>A-NET-ZsZ-Outbound-A</b>: Abnormal outbound connection from zone for asset<br> ↳ <b>A-NET-HsZ-Outbound-F</b>: First outbound connection from zone for asset<br> ↳ <b>A-NET-HsZ-Outbound-A</b>: Abnormal outbound connection from zone<br> ↳ <b>A-NET-OdH-Inbound-F</b>: First inbound connection to host for the organization.<br> ↳ <b>A-NET-OdH-Inbound-A</b>: Abnormal inbound connection to host for the organization.<br> ↳ <b>A-NET-ZdH-Inbound-F</b>: First inbound connection to host for the zone.<br> ↳ <b>EPA-PT-F</b>: Process accessed this internet IP address for the first time<br><br><b>TA0008 - TA0008</b><br> ↳ <b>EPA-PI-F</b>: Process accessed a local network IP address for the first time<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>A-NET-TOR-Outbound</b>: Outbound connection to a known TOR IP<br> ↳ <b>A-NET-TOR-Inbound</b>: Inbound connection from a known TOR IP<br> ↳ <b>EPA-PI-TorIp</b>: Process has created a connection to known Tor exit node<br><br><b>T1190 - Exploit Public Fasing Application</b><br> ↳ <b>A-NET-HdPort-Inbound-F</b>: First inbound connection on port for asset<br> ↳ <b>A-NET-HdPort-Inbound-A</b>: Abnormal inbound network connection to this port for asset<br> ↳ <b>A-NET-ZdPort-Inbound-F</b>: First inbound connection on port for zone<br> ↳ <b>A-NET-ZdPort-Inbound-A</b>: Abnormal inbound connection on port for zone<br> ↳ <b>A-NET-HCountry-Inbound-F</b>: First inbound connection from this country for asset<br> ↳ <b>A-NET-HCountry-Inbound-A</b>: Abnormal connection from this country for asset<br> ↳ <b>A-NET-ZCountry-Inbound-F</b>: First inbound connection from this country for zone<br> ↳ <b>A-NET-ZCountry-Inbound-A</b>: Abnormal connection from this country for the zone<br> ↳ <b>A-NET-OCountry-Inbound-F</b>: First inbound connection from this country for organization<br> ↳ <b>A-NET-OCountry-Inbound-A</b>: Abnormal connection from this country for the organization<br> ↳ <b>A-NET-Log4j-IP</b>: Asset was accessed by an external IP associated with Log4j exploit<br><br><b>T1071 - Application Layer Protocol</b><br> ↳ <b>A-NET-ZdH-Inbound-A</b>: Abnormal inbound connection to host for the zone. |  • <b>EPA-PT</b>: Network destination types (LAN/WAN) accessed by processes on host<br> • <b>EPA-PI</b>: Network destinations accessed by processes on host<br> • <b>A-NET-ZdH-Inbound</b>: Hosts receiving inbound communications in the zone<br> • <b>A-NET-OdH-Inbound</b>: Hosts receiving inbound communications in the organization<br> • <b>A-NET-HsZ-Outbound</b>: Outbound communicating zones for the asset<br> • <b>A-NET-ZsZ-Outbound</b>: Outbound communicating zones<br> • <b>A-NET-OsZ-Outbound</b>: Outbound communicating zones in the organization<br> • <b>A-NET-HsH-Outbound</b>: Outbound communicating hosts for the asset<br> • <b>A-NET-ZsH-Outbound</b>: Outbound communicating hosts in the zone<br> • <b>A-NET-OsH-Outbound</b>: Outbound communicating hosts<br> • <b>A-NET-OdPort-Inbound</b>: Inbound destination ports per organization<br> • <b>A-NET-OCountry-Outbound</b>: Outbound country per organization<br> • <b>A-NET-ZCountry-Outbound</b>: Outbound country per zone<br> • <b>A-NET-HCountry-Outbound</b>: Outbound country per asset<br> • <b>A-NET-OCountry-Inbound</b>: Origination country per organization<br> • <b>A-NET-ZCountry-Inbound</b>: Origination country per zone<br> • <b>A-NET-HCountry-Inbound</b>: Inbound country per asset<br> • <b>A-NET-ZdPort-Inbound</b>: Inbound destination ports per zone<br> • <b>A-NET-HdPort-Inbound</b>: Inbound destination ports per asset |
| security-alert        | <b>T1027.005 - Obfuscated Files or Information: Indicator Removal from Tools</b><br> ↳ <b>A-ALERT-DL</b>: DL Correlation rule alert on asset<br> ↳ <b>ALERT-DL</b>: DL Correlation rule alert on asset accessed by this user    |    |