Vendor: Amazon
==============
### Product: [AWS CloudTrail](../ds_amazon_aws_cloudtrail.md)
### Use-Case: [Abnormal Authentication & Access](../../../../UseCases/uc_abnormal_authentication_&_access.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  30   |   13   |     5      |      9      |    9    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| account-password-change     | <b>T1078 - Valid Accounts</b><br> ↳ <b>DORMANT-USER</b>: Dormant User<br> ↳ <b>AE-UA-F</b>: First activity type for user    |  • <b>AE-UA</b>: All activity for users    |
| app-activity    | <b>T1078 - Valid Accounts</b><br> ↳ <b>DORMANT-USER</b>: Dormant User<br> ↳ <b>AE-UA-F</b>: First activity type for user<br> ↳ <b>UA-GC-F</b>: First activity from country for group<br> ↳ <b>UA-GC-A</b>: Abnormal activity from country for group<br> ↳ <b>UA-OC-F</b>: First activity from country for organization<br> ↳ <b>UA-OC-A</b>: Abnormal activity from country for organization<br> ↳ <b>NEW-USER-F</b>: User with no event history<br> ↳ <b>UA-UC-new</b>: Abnormal country for user by new user<br> ↳ <b>UA-GC-new</b>: Abnormal country for group by new user<br> ↳ <b>UA-OC-new</b>: Abnormal country for organization by new user<br><br><b>T1133 - External Remote Services</b><br> ↳ <b>UA-UC-F</b>: First activity from country for user<br> ↳ <b>UA-UC-A</b>: Abnormal activity from country for user<br> ↳ <b>UA-GC-F</b>: First activity from country for group<br> ↳ <b>UA-GC-A</b>: Abnormal activity from country for group<br> ↳ <b>UA-OC-F</b>: First activity from country for organization<br> ↳ <b>UA-OC-A</b>: Abnormal activity from country for organization<br> ↳ <b>UA-UC-new</b>: Abnormal country for user by new user<br> ↳ <b>UA-GC-new</b>: Abnormal country for group by new user<br> ↳ <b>UA-OC-new</b>: Abnormal country for organization by new user    |  • <b>UA-OC</b>: Countries for organization<br> • <b>UA-GC</b>: Countries for peer groups<br> • <b>UA-UC</b>: Countries for user activity<br> • <b>AE-UA</b>: All activity for users    |
| app-login    | <b>T1078 - Valid Accounts</b><br> ↳ <b>DORMANT-USER</b>: Dormant User<br> ↳ <b>AE-UA-F</b>: First activity type for user<br> ↳ <b>UA-GC-F</b>: First activity from country for group<br> ↳ <b>UA-GC-A</b>: Abnormal activity from country for group<br> ↳ <b>UA-OC-F</b>: First activity from country for organization<br> ↳ <b>UA-OC-A</b>: Abnormal activity from country for organization<br> ↳ <b>NEW-USER-F</b>: User with no event history<br> ↳ <b>UA-UC-new</b>: Abnormal country for user by new user<br> ↳ <b>UA-GC-new</b>: Abnormal country for group by new user<br> ↳ <b>UA-OC-new</b>: Abnormal country for organization by new user<br><br><b>T1133 - External Remote Services</b><br> ↳ <b>UA-UC-F</b>: First activity from country for user<br> ↳ <b>UA-UC-A</b>: Abnormal activity from country for user<br> ↳ <b>UA-GC-F</b>: First activity from country for group<br> ↳ <b>UA-GC-A</b>: Abnormal activity from country for group<br> ↳ <b>UA-OC-F</b>: First activity from country for organization<br> ↳ <b>UA-OC-A</b>: Abnormal activity from country for organization<br> ↳ <b>UA-UC-new</b>: Abnormal country for user by new user<br> ↳ <b>UA-GC-new</b>: Abnormal country for group by new user<br> ↳ <b>UA-OC-new</b>: Abnormal country for organization by new user    |  • <b>UA-OC</b>: Countries for organization<br> • <b>UA-GC</b>: Countries for peer groups<br> • <b>UA-UC</b>: Countries for user activity<br> • <b>AE-UA</b>: All activity for users    |
| cloud-admin-activity        | <b>T1136.003 - Create Account: Create: Cloud Account</b><br> ↳ <b>CS-Critical-Activity-F</b>: First time for this user to perform a critical Cloud Administrative operation<br> ↳ <b>CS-Critical-Activity-A</b>: Abnormal user to perform a critical Cloud Administrative operation<br><br><b>T1078.004 - Valid Accounts: Cloud Accounts</b><br> ↳ <b>CS-UA-O-F</b>: First user agent to access cloud services in the organization<br> ↳ <b>CS-UA-O-A</b>: Abnormal user agent accessing cloud services in the organization    |  • <b>CS-Critical-Activities</b>: Users who perform critical IAM activites<br> • <b>CS-O-UA</b>: User agents in the organization accessing cloud storage    |
| cloud-admin-activity-failed | <b>T1136.003 - Create Account: Create: Cloud Account</b><br> ↳ <b>CS-Critical-Activity-F</b>: First time for this user to perform a critical Cloud Administrative operation<br> ↳ <b>CS-Critical-Activity-A</b>: Abnormal user to perform a critical Cloud Administrative operation<br><br><b>T1078.004 - Valid Accounts: Cloud Accounts</b><br> ↳ <b>CS-UA-O-F</b>: First user agent to access cloud services in the organization<br> ↳ <b>CS-UA-O-A</b>: Abnormal user agent accessing cloud services in the organization    |  • <b>CS-Critical-Activities</b>: Users who perform critical IAM activites<br> • <b>CS-O-UA</b>: User agents in the organization accessing cloud storage    |
| storage-access    | <b>T1530 - Data from Cloud Storage Object</b><br> ↳ <b>B-CS-Bucket-UA-F</b>: New user agent has accessed this bucket, possible exfiltration<br> ↳ <b>B-CS-Bucket-UA-A</b>: Abnormal user agent access to this bucket, possible exfiltration<br> ↳ <b>B-CS-Bucket-Users-F</b>: First time for user to access this bucket<br> ↳ <b>B-CS-Bucket-Users-A</b>: Abnormal user accessing this storage container/bucket<br> ↳ <b>B-CS-Bucket-Activity-F</b>: First type of object access against this bucket<br> ↳ <b>B-CS-Bucket-Activity-A</b>: Abnormal type of object access against this bucket<br> ↳ <b>CS-Storage-Activity-F</b>: First time using this event activity against the cloud storage service<br> ↳ <b>CS-Storage-Activity-A</b>: Abnormal activity against the cloud storage service<br> ↳ <b>CS-Users-F</b>: First time this user is seen accessing the cloud storage service<br> ↳ <b>CS-Users-A</b>: Abnormal user is seen accessing the cloud storage service<br> ↳ <b>B-CS-UType-F</b>: First time this specific user type has accessed this bucket<br> ↳ <b>B-CS-UType-A</b>: Abnormal for this user type to access this bucket<br><br><b>T1078.004 - Valid Accounts: Cloud Accounts</b><br> ↳ <b>CS-UA-O-F</b>: First user agent to access cloud services in the organization<br> ↳ <b>CS-UA-O-A</b>: Abnormal user agent accessing cloud services in the organization<br> ↳ <b>CS-UA-P-F</b>: First user agent for peer group to access cloud services<br> ↳ <b>CS-UA-P-A</b>: Abnormal user agent for the peer group accessing cloud service |  • <b>B-CS-IType</b>: User Identity types per cloud storage container<br> • <b>CS-Users</b>: Users accessing cloud storage in the org<br> • <b>CS-Storage-Activity</b>: Cloud storage activities for the user<br> • <b>B-CS-Bucket-Activity</b>: Activities per storage container/bucket<br> • <b>B-CS-Bucket-Users</b>: Users per storage container/bucket<br> • <b>B-CS-Bucket-UA</b>: User agents per bucket<br> • <b>CS-P-UA</b>: User agents accessing cloud storage per peer group<br> • <b>CS-O-UA</b>: User agents in the organization accessing cloud storage |
| storage-activity    | <b>T1530 - Data from Cloud Storage Object</b><br> ↳ <b>B-CS-Bucket-UA-F</b>: New user agent has accessed this bucket, possible exfiltration<br> ↳ <b>B-CS-Bucket-UA-A</b>: Abnormal user agent access to this bucket, possible exfiltration<br> ↳ <b>B-CS-Bucket-Users-A</b>: Abnormal user accessing this storage container/bucket<br> ↳ <b>CS-Storage-Activity-F</b>: First time using this event activity against the cloud storage service<br> ↳ <b>CS-Storage-Activity-A</b>: Abnormal activity against the cloud storage service<br> ↳ <b>CS-Users-F</b>: First time this user is seen accessing the cloud storage service<br> ↳ <b>CS-Users-A</b>: Abnormal user is seen accessing the cloud storage service<br><br><b>T1078.004 - Valid Accounts: Cloud Accounts</b><br> ↳ <b>CS-UA-O-F</b>: First user agent to access cloud services in the organization<br> ↳ <b>CS-UA-O-A</b>: Abnormal user agent accessing cloud services in the organization<br> ↳ <b>CS-UA-P-F</b>: First user agent for peer group to access cloud services<br> ↳ <b>CS-UA-P-A</b>: Abnormal user agent for the peer group accessing cloud service    |  • <b>CS-Users</b>: Users accessing cloud storage in the org<br> • <b>CS-Storage-Activity</b>: Cloud storage activities for the user<br> • <b>B-CS-Bucket-Users</b>: Users per storage container/bucket<br> • <b>B-CS-Bucket-UA</b>: User agents per bucket<br> • <b>CS-P-UA</b>: User agents accessing cloud storage per peer group<br> • <b>CS-O-UA</b>: User agents in the organization accessing cloud storage    |
| storage-activity-failed     | <b>T1530 - Data from Cloud Storage Object</b><br> ↳ <b>B-CS-Bucket-UA-A</b>: Abnormal user agent access to this bucket, possible exfiltration<br> ↳ <b>CS-Storage-Activity-F</b>: First time using this event activity against the cloud storage service<br> ↳ <b>CS-Storage-Activity-A</b>: Abnormal activity against the cloud storage service<br> ↳ <b>CS-Users-F</b>: First time this user is seen accessing the cloud storage service<br><br><b>T1078.004 - Valid Accounts: Cloud Accounts</b><br> ↳ <b>CS-UA-O-F</b>: First user agent to access cloud services in the organization<br> ↳ <b>CS-UA-O-A</b>: Abnormal user agent accessing cloud services in the organization<br> ↳ <b>CS-UA-P-F</b>: First user agent for peer group to access cloud services<br> ↳ <b>CS-UA-P-A</b>: Abnormal user agent for the peer group accessing cloud service    |  • <b>CS-Users</b>: Users accessing cloud storage in the org<br> • <b>CS-Storage-Activity</b>: Cloud storage activities for the user<br> • <b>B-CS-Bucket-UA</b>: User agents per bucket<br> • <b>CS-P-UA</b>: User agents accessing cloud storage per peer group<br> • <b>CS-O-UA</b>: User agents in the organization accessing cloud storage    |