Vendor: Cisco
=============
### Product: [Cisco NPE](../ds_cisco_cisco_npe.md)
### Use-Case: [Ransomware](../../../../UseCases/uc_ransomware.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  20   |   0    |     6      |      1      |    1    |

| Event Type      | Rules                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | Models |
| --------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------ |
| process-created | <b>T1055 - Process Injection</b><br> ↳ <b>A-WannaCry</b>: Artifacts seen by WannaCry malware have been observed on this asset<br> ↳ <b>WannaCry</b>: Artifacts seen by WannaCry malware have been observed<br><br><b>T1070.004 - Indicator Removal on Host: File Deletion</b><br> ↳ <b>Fsutil-Sus-Invocation</b>: Suspicious parameters of fsutil were detected.<br><br><b>T1003 - OS Credential Dumping</b><br> ↳ <b>NotPetya-Activity{
    RuleName = "NotPetya Ransomware Activity detected"
    RuleDescription = "Artifacts of ransomware, NotPetya, were observed. Specifically, extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil. Reference: https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_malware_notpetya.yml"
    ReasonTemplate = "Possible ransomeware, NotPetya, was detected."
    AggregateReasonTemplate = "Possible ransomeware, NotPetya, was detected."
    RuleType = "endpoint"
    RuleCategory = "Endpoint Activity"
    ClassifyIf = """TRUE"""
    RuleEventTypes = [
    "process-created"
    ]
    Disabled = "FALSE"
    Model = "FACT"
    FactFeatureName = "process_name"
    Score = "10.0"
    RuleExpression = """(toLower(process_name)='fsutil.exe' && contains(toLower(command_line), ' deletejournal ')) || ((contains(toLower(command_line), '\\\\AppData\\\\Local\\\\Temp') && contains(toLower(command_line), '\\\\.\\pipe\\')) || (toLower(process_name)='wevtutil.exe' && contains(toLower(command_line), ' cl ')) || (toLower(process_name)='rundll32.exe' && endswith(toLower(command_line), '.dat,#1'))) && !WasRuleFired('NotPetya-Activity')"""
    DependencyExpression = "NA"
    RuleLabels</b>: NotPetya Ransomware Activity detected<br><br><b>T1070 - Indicator Removal on Host</b><br> ↳ <b>NotPetya-Activity{
    RuleName = "NotPetya Ransomware Activity detected"
    RuleDescription = "Artifacts of ransomware, NotPetya, were observed. Specifically, extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil. Reference: https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_malware_notpetya.yml"
    ReasonTemplate = "Possible ransomeware, NotPetya, was detected."
    AggregateReasonTemplate = "Possible ransomeware, NotPetya, was detected."
    RuleType = "endpoint"
    RuleCategory = "Endpoint Activity"
    ClassifyIf = """TRUE"""
    RuleEventTypes = [
    "process-created"
    ]
    Disabled = "FALSE"
    Model = "FACT"
    FactFeatureName = "process_name"
    Score = "10.0"
    RuleExpression = """(toLower(process_name)='fsutil.exe' && contains(toLower(command_line), ' deletejournal ')) || ((contains(toLower(command_line), '\\\\AppData\\\\Local\\\\Temp') && contains(toLower(command_line), '\\\\.\\pipe\\')) || (toLower(process_name)='wevtutil.exe' && contains(toLower(command_line), ' cl ')) || (toLower(process_name)='rundll32.exe' && endswith(toLower(command_line), '.dat,#1'))) && !WasRuleFired('NotPetya-Activity')"""
    DependencyExpression = "NA"
    RuleLabels</b>: NotPetya Ransomware Activity detected<br><br><b>T1218.011 - Signed Binary Proxy Execution: Rundll32</b><br> ↳ <b>NotPetya-Activity{
    RuleName = "NotPetya Ransomware Activity detected"
    RuleDescription = "Artifacts of ransomware, NotPetya, were observed. Specifically, extracted passwords are passed back to the main module via named pipe, the file system journal of drive C is deleted and windows eventlogs are cleared using wevtutil. Reference: https://github.com/Neo23x0/sigma/blob/master/rules/windows/process_creation/win_malware_notpetya.yml"
    ReasonTemplate = "Possible ransomeware, NotPetya, was detected."
    AggregateReasonTemplate = "Possible ransomeware, NotPetya, was detected."
    RuleType = "endpoint"
    RuleCategory = "Endpoint Activity"
    ClassifyIf = """TRUE"""
    RuleEventTypes = [
    "process-created"
    ]
    Disabled = "FALSE"
    Model = "FACT"
    FactFeatureName = "process_name"
    Score = "10.0"
    RuleExpression = """(toLower(process_name)='fsutil.exe' && contains(toLower(command_line), ' deletejournal ')) || ((contains(toLower(command_line), '\\\\AppData\\\\Local\\\\Temp') && contains(toLower(command_line), '\\\\.\\pipe\\')) || (toLower(process_name)='wevtutil.exe' && contains(toLower(command_line), ' cl ')) || (toLower(process_name)='rundll32.exe' && endswith(toLower(command_line), '.dat,#1'))) && !WasRuleFired('NotPetya-Activity')"""
    DependencyExpression = "NA"
    RuleLabels</b>: NotPetya Ransomware Activity detected<br><br><b>T1490 - Inhibit System Recovery</b><br> ↳ <b>EPA-EXPERT-SHADOW-COPIES</b>: A Suspicious command that deletes shadow copies has been executed for process<br> ↳ <b>EPA-EXPERT-DISABLE-RECOVERY</b>: A Suspicious command that disables recovery mode has been executed for process |        |