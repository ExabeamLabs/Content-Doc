Vendor: Unix
============
### Product: [Auditbeat](../ds_unix_auditbeat.md)
### Use-Case: [Malware](../../../../UseCases/uc_malware.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  54   |   15   |     19     |      6      |    6    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| app-activity    | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Blacklist-Shost</b>: User authentication or login from a known blacklisted IP    |    |
| app-login    | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Blacklist-Shost</b>: User authentication or login from a known blacklisted IP    |    |
| process-created-failed | <b>T1059.005 - T1059.005</b><br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1059.007 - T1059.007</b><br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1218.005 - T1218.005</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>A-Mshta-Script</b>: Mshta.exe .NET code execution on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br> ↳ <b>Mshta-Script</b>: Mshta.exe .NET code execution<br><br><b>T1047 - Windows Management Instrumentation</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1127.001 - Trusted Developer Utilities Proxy Execution: MSBuild</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1218.004 - Signed Binary Proxy Execution: InstallUtil</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.<br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>T1218.010 - Signed Binary Proxy Execution: Regsvr32</b><br> ↳ <b>PC-ParentName-ProcessName-DotNET-A</b>: Abnormal child process creation for .NET associated process<br> ↳ <b>DotNET-URL</b>: DotNET command line contains remote file<br><br><b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>EPA-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user during endpoint activity<br> ↳ <b>EPA-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user during endpoint activity<br><br><b>T1218.001 - Signed Binary Proxy Execution: Compiled HTML File</b><br> ↳ <b>A-DotNET-URL</b>: DotNET command line contains remote file on this asset.    |  • <b>PC-ParentName-ProcessName</b>: Child processes created by a parent process<br> • <b>EPA-UP-TEMP</b>: Process executable TEMP directories for this user during endpoint activity<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset    |
| process-network        | <b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-HP-F</b>: First execution of process on asset<br> ↳ <b>A-EPA-HP-A</b>: Abnormal execution of process on asset<br> ↳ <b>A-EPA-ZP-A</b>: Abnormal execution of process for the asset in this zone<br> ↳ <b>A-EPA-ZP-F</b>: First execution of process for the asset in this zone<br> ↳ <b>A-EPA-OP-F</b>: First execution of process for the asset in this organization<br> ↳ <b>A-EPA-OP-A</b>: Abnormal execution of process for the asset in this organization<br> ↳ <b>A-EPA-HPP-F</b>: First parent-process combination on asset<br> ↳ <b>A-EPA-HPP-A</b>: Abnormal parent-process combination on asset<br> ↳ <b>A-EPA-OPP-F</b>: First parent-process combination in this organization<br> ↳ <b>A-EPA-OPP-A</b>: Abnormal parent-process combination in this organization<br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>EPA-UH-Pen-F</b>: Known pentest tool used<br> ↳ <b>EPA-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user during endpoint activity<br> ↳ <b>EPA-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user during endpoint activity<br><br><b>T1568.002 - Dynamic Resolution: Domain Generation Algorithms</b><br> ↳ <b>EPA-UD-DGA-F</b>: First access to this domain through network which has been identified as DGA<br> ↳ <b>EPA-UD-DGA-A</b>: Abnormal access to this domain through network which has been identified as DGA<br> ↳ <b>EPA-UD-DGA-N</b>: Common access to this domain through network which has been identified as DGA<br><br><b>TA0010 - TA0010</b><br> ↳ <b>EPA-PI-ThreatIp</b>: Process has created a connection to a bad reputation IP address<br><br><b>TA0011 - TA0011</b><br> ↳ <b>A-NET-TI-H-Outbound</b>: Outbound connection to a known malicious host<br> ↳ <b>A-NET-TI-IP-Inbound</b>: Inbound connection from a known malicious IP<br> ↳ <b>A-NET-TI-H-Inbound</b>: Inbound connection from a known malicious host<br> ↳ <b>EPA-PI-ThreatIp</b>: Process has created a connection to a bad reputation IP address    |  • <b>EPA-UP-TEMP</b>: Process executable TEMP directories for this user during endpoint activity<br> • <b>EPA-UH-Pen</b>: Malicious tools used by user<br> • <b>EPA-UD-DGA</b>: Top web domains that seem to be DGA generated for this user<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset<br> • <b>A-EPA-OPP</b>: Parent processes in the organization<br> • <b>A-EPA-HPP</b>: Parent processes per host on this asset<br> • <b>A-EPA-ZP</b>: Processes in the zone on asset    |
| remote-logon    | <b>TA0002 - TA0002</b><br> ↳ <b>A-EPA-TEMP-DIRECTORY-F</b>: First execution of this process from a temporary directory on this asset<br> ↳ <b>A-EPA-TEMP-DIRECTORY-A</b>: Abnormal execution of this process from a temporary directory<br> ↳ <b>DEF-TEMP-DIRECTORY-F</b>: First time process has been executed from a temporary directory by this user<br> ↳ <b>DEF-TEMP-DIRECTORY-A</b>: Abnormal process has been executed from a temporary directory by this user<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Blacklist-Shost</b>: User authentication or login from a known blacklisted IP<br><br><b>T1550.003 - Use Alternate Authentication Material: Pass the Ticket</b><br> ↳ <b>EXPERT-PENTEST-DOMAINS</b>: Possible credentials theft attack detected<br><br><b>T1558 - Steal or Forge Kerberos Tickets</b><br> ↳ <b>EXPERT-PENTEST-DOMAINS</b>: Possible credentials theft attack detected    |  • <b>AE-UP-TEMP</b>: Process executable TEMP directories for this user during a session<br> • <b>A-EPA-UP-TEMP</b>: Processes executed from TEMP directories on this asset    |
| web-activity-denied    | <b>T1189 - Drive-by Compromise</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1204.001 - T1204.001</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1566.002 - Phishing: Spearphishing Link</b><br> ↳ <b>WEB-URank-Binary</b>: Executable download from first low ranked web domain<br><br><b>T1071.001 - Application Layer Protocol: Web Protocols</b><br> ↳ <b>A-WEB-DGA</b>: Asset has accessed a domain that has been identified as DGA<br> ↳ <b>A-WEB-Reputation-URL</b>: Asset attempted access to a url with bad reputation<br> ↳ <b>A-WEB-Reputation-Domain</b>: Asset attempted access to a domain with bad reputation<br> ↳ <b>A-WEB-Reputation-IP</b>: Asset attempted to connect to IP address with bad reputation<br> ↳ <b>A-WEB-IOC</b>: Indicator of Compromise (IOC) found in asset's web activity<br> ↳ <b>A-WEB-ALERT</b>: Asset attempted access to a domain with malicious reputation<br> ↳ <b>A-WEBF-IP-Country-F</b>: Asset failed to directly connect to an IP address in a country never before accessed<br> ↳ <b>A-WEBF-IP-Country-A</b>: Abnormal direct access to an IP address by the asset belonging to an abnormal country for the asset to access has failed<br> ↳ <b>WEB-UU-Reputation</b>: User attempted access to a url with bad reputation<br> ↳ <b>WEB-UD-Reputation-F</b>: First access to this web domain which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UD-Reputation-A</b>: Abnormal access to this web domain which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UD-Reputation-N</b>: Common access to this web domain which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UI-Reputation-F</b>: First access to this internet IP address which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UI-Reputation-A</b>: Abnormal access to this IP address which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-UI-Reputation-N</b>: Common access to this IP address which has been identified as risky by a reputation feed.<br> ↳ <b>WEB-IOC</b>: Indicator of Compromise (IOC) found in user's web activity<br> ↳ <b>WEB-UD-ALERT-A</b>: Abnormal security alert accessing this malicious domain for user<br> ↳ <b>WEB-UD-ALERT-N</b>: Common security alert on this malicious domain for user<br> ↳ <b>WEB-URank-F</b>: First web activity to this low ranked web domain<br> ↳ <b>WEB-URank-A</b>: Abnormal web activity to this low ranked web domain<br><br><b>T1568.002 - Dynamic Resolution: Domain Generation Algorithms</b><br> ↳ <b>A-WEB-DGA</b>: Asset has accessed a domain that has been identified as DGA<br> ↳ <b>WEB-UD-DGA-A</b>: Abnormal access to this domain which has been identified as DGA<br> ↳ <b>WEB-UD-DGA-N</b>: Common access to this domain which has been identified as DGA |  • <b>WEB-URank</b>: Web activity to low ranked domains for the user<br> • <b>WEB-UD-ALERT</b>: Top malicious web domain accessed by the user<br> • <b>WEB-UI-Reputation</b>: Top ip addresses flagged by a reputation service that have been accessed by the user<br> • <b>WEB-UD-Reputation</b>: Top web domain flagged by a reputation service that have been accessed by the user<br> • <b>WEB-UD-DGA</b>: Top web domains per user that seem to be DGA generated during web activity<br> • <b>A-WEB-IP</b>: IPs an asset has directly browsed to |