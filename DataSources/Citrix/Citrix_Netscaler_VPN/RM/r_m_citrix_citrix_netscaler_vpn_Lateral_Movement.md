Vendor: Citrix
==============
### Product: [Citrix Netscaler VPN](../ds_citrix_citrix_netscaler_vpn.md)
### Use-Case: [Lateral Movement](../../../../UseCases/uc_lateral_movement.md)

| Rules | Models | MITRE ATT&CK® TTPs | Event Types | Parsers |
|:-----:|:------:|:------------------:|:-----------:|:-------:|
|  56   |   20   |         11         |      6      |    6    |

| Event Type    | Rules    | Models    |
| ---- | ---- | ---- |
| authentication-failed     | <b>T1078 - Valid Accounts</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost-Failed</b>: User authentication or login failure from a known TOR IP    |    |
| authentication-successful | <b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost</b>: User authentication or login from a known TOR IP    |    |
| remote-access    | <b>T1021 - Remote Services</b><br> ↳ <b>A-RLA-sHdZ-F</b>: First remote access to zone from asset<br> ↳ <b>A-RLA-sHdZ-A</b>: Abnormal remote access to zone from asset<br> ↳ <b>A-RLA-dHsZ-F</b>: First remote access from zone to asset<br> ↳ <b>A-RLA-dHsZ-A</b>: Abnormal remote access from zone to asset<br> ↳ <b>RA-UH-sZ-F</b>: First remote access to asset from first or abnormal zone<br> ↳ <b>RA-UH-sZ-A</b>: Abnormal remote access to asset from first or abnormal zone<br> ↳ <b>RLA-UsZ-F</b>: First source network zone for user<br> ↳ <b>RLA-UsZ-A</b>: Abnormal source network zone for user<br> ↳ <b>RLA-UsH-dZ-F</b>: First remote access to zone from new asset<br> ↳ <b>RLA-UsH-dZ-A</b>: Abnormal remote access to zone from new asset<br> ↳ <b>RLA-dZsZ-F</b>: First inter-zone communication from destination to source<br> ↳ <b>RLA-sZdZ-F</b>: First inter-zone communication from source to destination<br> ↳ <b>RLA-sZdZ-A</b>: Abnormal inter-zone communication<br> ↳ <b>RA-UH-CS-NC</b>: Remote access  to a critical system for user with no information<br> ↳ <b>RA-F-F-CS</b>: First remote access to critical system for user<br> ↳ <b>RA-F-A-CS</b>: Abnormal remote access to critical system for user<br> ↳ <b>RA-UH-A</b>: Abnormal access to asset<br> ↳ <b>RA-UH-F</b>: First access to asset<br> ↳ <b>RA-GH-A-new</b>: Abnormal access to asset for group by new user<br> ↳ <b>RA-GH-F-new</b>: First access to asset for group by a new user<br> ↳ <b>RA-HT-EXEC-new</b>: New user remote access to executive asset<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>RA-UH-sZ-F</b>: First remote access to asset from first or abnormal zone<br> ↳ <b>RA-UH-sZ-A</b>: Abnormal remote access to asset from first or abnormal zone<br> ↳ <b>RLA-UsZ-F</b>: First source network zone for user<br> ↳ <b>RLA-UsZ-A</b>: Abnormal source network zone for user<br> ↳ <b>RLA-UsH-dZ-F</b>: First remote access to zone from new asset<br> ↳ <b>RLA-UsH-dZ-A</b>: Abnormal remote access to zone from new asset<br> ↳ <b>RLA-dZsZ-F</b>: First inter-zone communication from destination to source<br> ↳ <b>RLA-sZdZ-F</b>: First inter-zone communication from source to destination<br> ↳ <b>RLA-sZdZ-A</b>: Abnormal inter-zone communication<br> ↳ <b>RA-UH-CS-NC</b>: Remote access  to a critical system for user with no information<br> ↳ <b>RA-F-F-CS</b>: First remote access to critical system for user<br> ↳ <b>RA-F-A-CS</b>: Abnormal remote access to critical system for user<br> ↳ <b>RA-UH-A</b>: Abnormal access to asset<br> ↳ <b>RA-UH-F</b>: First access to asset<br> ↳ <b>RA-GH-A-new</b>: Abnormal access to asset for group by new user<br> ↳ <b>RA-GH-F-new</b>: First access to asset for group by a new user<br> ↳ <b>RA-HT-EXEC-new</b>: New user remote access to executive asset<br><br><b>T1550.002 - Use Alternate Authentication Material: Pass the Hash</b><br> ↳ <b>A-AE-SwSh-F</b>: New server hostname using NTLM authentication in the organization.<br> ↳ <b>A-NTLM-WsSrv</b>: Hostname contains workstation or server<br> ↳ <b>A-NTLM-mismatch</b>: Mismatch between logged and resolved hostnames<br> ↳ <b>A-PTH-ALERT-sH-Possible</b>: Possible pass the hash attack with keylength of 0 in NTLM event and a 'null' sid on this source host.<br> ↳ <b>AE-NTLM-WsSrv</b>: New generic hostname found using ntlm authentication<br> ↳ <b>NTLM-mismatch</b>: <br> ↳ <b>PTH-ALERT-sH-Possible</b>: Possible pass the hash attack with keylength of 0 in NTLM event and a 'null' sid.<br><br><b>T1550 - Use Alternate Authentication Material</b><br> ↳ <b>RLA-UAPackage-F</b>: First time usage of Windows authentication package<br> ↳ <b>RLA-UAPackage-A</b>: Abnormal usage of Windows authentication package<br><br><b>T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting</b><br> ↳ <b>A-KL-ToEt-Roast</b>: Suspicious or weak encryption type used for obtaining the kerberos TGTs using non kerberos service for this asset<br> ↳ <b>KL-ToEt-Roast</b>: Suspicious or weak encryption type used for obtaining kerberos TGTs using non kerberos service<br><br><b>T1550.003 - Use Alternate Authentication Material: Pass the Ticket</b><br> ↳ <b>EXPERT-PENTEST-DOMAINS</b>: Possible credentials theft attack detected<br><br><b>T1558 - Steal or Forge Kerberos Tickets</b><br> ↳ <b>EXPERT-PENTEST-DOMAINS</b>: Possible credentials theft attack detected<br><br><b>T1018 - Remote System Discovery</b><br> ↳ <b>A-RLA-sHdZ-F</b>: First remote access to zone from asset<br> ↳ <b>A-RLA-sHdZ-A</b>: Abnormal remote access to zone from asset<br> ↳ <b>A-RLA-dHsZ-F</b>: First remote access from zone to asset<br> ↳ <b>A-RLA-dHsZ-A</b>: Abnormal remote access from zone to asset |  • <b>AL-HT-EXEC</b>: Executive Assets<br> • <b>RA-GH</b>: Assets accessed by this peer group remotely<br> • <b>RLA-UAPackage</b>: Windows authentication packages used when connecting to remote hosts<br> • <b>RA-UH</b>: Assets accessed by this user remotely<br> • <b>AE-NTLM</b>: Models ntlm hostnames in the organization<br> • <b>AE-OHr</b>: Random hostnames<br> • <b>RLA-sZdZ</b>: Destination zone communication<br> • <b>RLA-dZsZ</b>: Source zone communication<br> • <b>AL-UsH</b>: Source hosts per User<br> • <b>RLA-UsZ</b>: Source zones for user<br> • <b>A-AE-OHr</b>: Random hostnames on asset<br> • <b>A-AE-NTLM</b>: Models the NTLM hostnames seen in the organization<br> • <b>A-RLA-dHsZ</b>: Destination Host to Source zone communication<br> • <b>A-RLA-sHdZ</b>: Source Host to Destination zone communication |
| remote-logon    | <b>T1021 - Remote Services</b><br> ↳ <b>A-RLA-sHdZ-F</b>: First remote access to zone from asset<br> ↳ <b>A-RLA-sHdZ-A</b>: Abnormal remote access to zone from asset<br> ↳ <b>A-RLA-dHsZ-F</b>: First remote access from zone to asset<br> ↳ <b>A-RLA-dHsZ-A</b>: Abnormal remote access from zone to asset<br> ↳ <b>RL-UH-sZ-F</b>: First remote logon to asset from new or abnormal source network zone<br> ↳ <b>RL-UH-sZ-A</b>: Abnormal remote logon to asset from new or abnormal source network zone<br> ↳ <b>RLA-UsZ-F</b>: First source network zone for user<br> ↳ <b>RLA-UsZ-A</b>: Abnormal source network zone for user<br> ↳ <b>RLA-UsH-dZ-F</b>: First remote access to zone from new asset<br> ↳ <b>RLA-UsH-dZ-A</b>: Abnormal remote access to zone from new asset<br> ↳ <b>RLA-dZsZ-F</b>: First inter-zone communication from destination to source<br> ↳ <b>RLA-sZdZ-F</b>: First inter-zone communication from source to destination<br> ↳ <b>RLA-sZdZ-A</b>: Abnormal inter-zone communication<br> ↳ <b>RL-UH-F</b>: First remote logon to asset<br> ↳ <b>RL-UH-A</b>: Abnormal remote logon to asset<br> ↳ <b>RL-GH-F</b>: First remote logon to asset for group<br> ↳ <b>RL-GH-A-new</b>: Abnormal remote logon to asset for group by new user<br> ↳ <b>RL-HU-F-new</b>: Remote logon to private asset for new user<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>RL-UH-sZ-F</b>: First remote logon to asset from new or abnormal source network zone<br> ↳ <b>RL-UH-sZ-A</b>: Abnormal remote logon to asset from new or abnormal source network zone<br> ↳ <b>RLA-UsZ-F</b>: First source network zone for user<br> ↳ <b>RLA-UsZ-A</b>: Abnormal source network zone for user<br> ↳ <b>RLA-UsH-dZ-F</b>: First remote access to zone from new asset<br> ↳ <b>RLA-UsH-dZ-A</b>: Abnormal remote access to zone from new asset<br> ↳ <b>RLA-dZsZ-F</b>: First inter-zone communication from destination to source<br> ↳ <b>RLA-sZdZ-F</b>: First inter-zone communication from source to destination<br> ↳ <b>RLA-sZdZ-A</b>: Abnormal inter-zone communication<br> ↳ <b>RL-UH-F</b>: First remote logon to asset<br> ↳ <b>RL-UH-A</b>: Abnormal remote logon to asset<br> ↳ <b>RL-GH-F</b>: First remote logon to asset for group<br> ↳ <b>RL-GH-A-new</b>: Abnormal remote logon to asset for group by new user<br> ↳ <b>RL-HU-F-new</b>: Remote logon to private asset for new user<br><br><b>T1550.002 - Use Alternate Authentication Material: Pass the Hash</b><br> ↳ <b>A-AE-SwSh-F</b>: New server hostname using NTLM authentication in the organization.<br> ↳ <b>A-NTLM-WsSrv</b>: Hostname contains workstation or server<br> ↳ <b>A-NTLM-mismatch</b>: Mismatch between logged and resolved hostnames<br> ↳ <b>A-PTH-ALERT-sH-Possible</b>: Possible pass the hash attack with keylength of 0 in NTLM event and a 'null' sid on this source host.<br> ↳ <b>AE-NTLM-WsSrv</b>: New generic hostname found using ntlm authentication<br> ↳ <b>NTLM-mismatch</b>: <br> ↳ <b>PTH-ALERT-sH-Possible</b>: Possible pass the hash attack with keylength of 0 in NTLM event and a 'null' sid.<br><br><b>T1550 - Use Alternate Authentication Material</b><br> ↳ <b>RLA-UAPackage-F</b>: First time usage of Windows authentication package<br> ↳ <b>RLA-UAPackage-A</b>: Abnormal usage of Windows authentication package<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>Auth-Tor-Shost</b>: User authentication or login from a known TOR IP<br><br><b>T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting</b><br> ↳ <b>A-KL-ToEt-Roast</b>: Suspicious or weak encryption type used for obtaining the kerberos TGTs using non kerberos service for this asset<br> ↳ <b>KL-ToEt-Roast</b>: Suspicious or weak encryption type used for obtaining kerberos TGTs using non kerberos service<br><br><b>T1550.003 - Use Alternate Authentication Material: Pass the Ticket</b><br> ↳ <b>EXPERT-PENTEST-DOMAINS</b>: Possible credentials theft attack detected<br><br><b>T1558 - Steal or Forge Kerberos Tickets</b><br> ↳ <b>EXPERT-PENTEST-DOMAINS</b>: Possible credentials theft attack detected<br><br><b>T1018 - Remote System Discovery</b><br> ↳ <b>A-RLA-sHdZ-F</b>: First remote access to zone from asset<br> ↳ <b>A-RLA-sHdZ-A</b>: Abnormal remote access to zone from asset<br> ↳ <b>A-RLA-dHsZ-F</b>: First remote access from zone to asset<br> ↳ <b>A-RLA-dHsZ-A</b>: Abnormal remote access from zone to asset    |  • <b>RL-HU</b>: Remote logon users<br> • <b>RL-GH-A</b>: Assets accessed remotely by this peer group<br> • <b>RLA-UAPackage</b>: Windows authentication packages used when connecting to remote hosts<br> • <b>RL-UH</b>: Remote logons<br> • <b>AE-NTLM</b>: Models ntlm hostnames in the organization<br> • <b>AE-OHr</b>: Random hostnames<br> • <b>RLA-sZdZ</b>: Destination zone communication<br> • <b>RLA-dZsZ</b>: Source zone communication<br> • <b>AL-UsH</b>: Source hosts per User<br> • <b>RLA-UsZ</b>: Source zones for user<br> • <b>A-AE-OHr</b>: Random hostnames on asset<br> • <b>A-AE-NTLM</b>: Models the NTLM hostnames seen in the organization<br> • <b>A-RLA-dHsZ</b>: Destination Host to Source zone communication<br> • <b>A-RLA-sHdZ</b>: Source Host to Destination zone communication    |
| vpn-logout    | <b>T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting</b><br> ↳ <b>KL-USnCOUNT-A</b>: Abnormal number of services used to obtain TGTs by user<br> ↳ <b>KL-GSnCOUNT-A</b>: Abnormal number of services used to obtain TGTs by peer group<br><br><b>T1021 - Remote Services</b><br> ↳ <b>RA-UHcount-S</b>: Abnormal number of accessed hosts for user (S)<br> ↳ <b>RA-UHcount-M</b>: Abnormal number of accessed hosts for user (M)<br> ↳ <b>RA-UHcount-L</b>: Abnormal number of accessed hosts for user (L)<br> ↳ <b>RA-OHcount</b>: Abnormal number of accessed hosts for the organization<br> ↳ <b>RA-GHcount</b>: Abnormal number of accessed assets for group<br><br><b>T1078 - Valid Accounts</b><br> ↳ <b>RA-UHcount-S</b>: Abnormal number of accessed hosts for user (S)<br> ↳ <b>RA-UHcount-M</b>: Abnormal number of accessed hosts for user (M)<br> ↳ <b>RA-UHcount-L</b>: Abnormal number of accessed hosts for user (L)<br> ↳ <b>RA-OHcount</b>: Abnormal number of accessed hosts for the organization<br> ↳ <b>RA-GHcount</b>: Abnormal number of accessed assets for group    |  • <b>KL-GSnCOUNT</b>: Count of services used to obtain kerberos TGTs in a session for peer group<br> • <b>KL-USnCOUNT</b>: Count of services used to obtain kerberos TGTs in a session for user<br> • <b>RA-OHcount</b>: Count of assets access per user in the organization    |
| web-activity-allowed      | <b>T1071.001 - Application Layer Protocol: Web Protocols</b><br> ↳ <b>WEB-URank-Tor</b>: User has accessed a tor-to-web proxy site<br><br><b>T1090.003 - Proxy: Multi-hop Proxy</b><br> ↳ <b>A-NET-TOR-Outbound</b>: Outbound connection to a known TOR IP<br> ↳ <b>A-WEB-TorProxy</b>: Asset has accessed a known Tor web proxy<br> ↳ <b>A-WEB-UU-Tor</b>: Asset has accessed a URL containing '/tor/server'<br> ↳ <b>WEB-UD-TorProxy</b>: User has accessed a known Tor web proxy<br> ↳ <b>WEB-UI-Tor</b>: User has accessed a known Tor exit node<br> ↳ <b>WEB-UU-Tor</b>: User has accessed a URL containing '/tor/server'<br> ↳ <b>WEB-URank-Tor</b>: User has accessed a tor-to-web proxy site<br><br><b>T1190 - Exploit Public Fasing Application</b><br> ↳ <b>A-NET-Log4j-IP</b>: Asset was accessed by an external IP associated with Log4j exploit    |    |