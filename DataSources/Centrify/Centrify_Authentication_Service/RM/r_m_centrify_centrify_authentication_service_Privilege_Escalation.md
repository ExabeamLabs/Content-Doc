Vendor: Centrify
================
### Product: [Centrify Authentication Service](../ds_centrify_centrify_authentication_service.md)
### Use-Case: [Privilege Escalation](../../../../UseCases/uc_privilege_escalation.md)

| Rules | Models | MITRE TTPs | Event Types | Parsers |
|:-----:|:------:|:----------:|:-----------:|:-------:|
|  82   |   16   |     43     |      5      |    5    |

| Event Type      | Rules    | Models    |
| ---- | ---- | ---- |
| account-switch  | <b>T1078 - Valid Accounts</b><br> ↳ <b>AS-UA-A</b>: Abnormal switch to target account for user<br> ↳ <b>AS-UA-F-PRIV</b>: Account switch to a privileged or executive account<br> ↳ <b>AS-UA-FS</b>: First account switch for user<br> ↳ <b>DC18-New</b>: New account switch to privileged account<br><br><b>T1555.005 - T1555.005</b><br> ↳ <b>AS-PV-OU-F</b>: First password retrieval activity for user in organization<br> ↳ <b>AS-PV-OG-F</b>: First password retrieval activity for user in peer group<br> ↳ <b>AS-PV-US-F</b>: First password retrieval using this safe value for user<br> ↳ <b>AS-PV-US-A</b>: Abnormal password retrieval using this safe value for user<br> ↳ <b>AS-PV-UT-A</b>: Abnormal user Password retrieval activity time<br> ↳ <b>AS-PV-UsH-F</b>: First password retrieval from asset for user    |  • <b>AS-PV-UsH</b>: Source Hosts using password retrieval accounts for user<br> • <b>AS-PV-UT-TOW</b>: Password retrieval activity time for user<br> • <b>AS-PV-US</b>: Safe values for user<br> • <b>AS-PV-OG</b>: Password retrieval activity for users in the peer group<br> • <b>AS-PV-OU</b>: Password retrieval activity for users in the organization<br> • <b>AS-UA</b>: Target credentials for user    |
| local-logon     | <b>T1078 - Valid Accounts</b><br> ↳ <b>AS-PV-UHWoPC</b>: Access to Password Vault managed asset with no password checkout for user<br> ↳ <b>DC18-new</b>: Account switch by new user<br><br><b>T1555.005 - T1555.005</b><br> ↳ <b>AS-PV-UHWoPC</b>: Access to Password Vault managed asset with no password checkout for user    |  • <b>AS-PV-OA</b>: Password retrieval based accounts    |
| process-created | <b>T1012 - Query Registry</b><br> ↳ <b>A-Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity on this asset, suspicious command line arguments<br> ↳ <b>A-EPA-REG-Query-F</b>: First execution of process with req query arguments for windows policies on this asset<br> ↳ <b>A-EPA-REG-Query-A</b>: Abnormal execution of process with req query arguments for windows policies on this asset<br> ↳ <b>Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity, suspicious command line arguments<br> ↳ <b>ATP-REG-Password</b>: Scanning registry hives via Reg Utility<br><br><b>T1047 - Windows Management Instrumentation</b><br> ↳ <b>WINCMD-WmiObject</b>: Powershell WMI object to enumerate network adapter was used<br> ↳ <b>ATP-WMIC-Antivirus</b>: Antivirus detection using windows utility msbuild.<br><br><b>T1127.001 - Trusted Developer Utilities Proxy Execution: MSBuild</b><br> ↳ <b>ATP-WMIC-Antivirus</b>: Antivirus detection using windows utility msbuild.<br><br><b>T1518.001 - T1518.001</b><br> ↳ <b>ATP-WMIC-Antivirus</b>: Antivirus detection using windows utility msbuild.<br><br><b>T1059.001 - Command and Scripting Interperter: PowerShell</b><br> ↳ <b>A-Powershell-Exec-DLL</b>: PowerShell Strings applied to rundllas.exe seen in PowerShdll.dll on this asset.<br> ↳ <b>A-Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity on this asset, suspicious command line arguments<br> ↳ <b>A-EPA-DLL</b>: Dll loaded from a temp folder via PowerShell on this asset<br> ↳ <b>WINCMD-WmiObject</b>: Powershell WMI object to enumerate network adapter was used<br> ↳ <b>Powershell-Exec-DLL</b>: PowerShell Strings applied to rundllas.exe seen in PowerShdll.dll<br> ↳ <b>Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity, suspicious command line arguments<br> ↳ <b>EPA-DLL</b>: Dll loaded from a temp folder via PowerShell<br><br><b>T1218.011 - Signed Binary Proxy Execution: Rundll32</b><br> ↳ <b>A-RunDll32-ControlPanel</b>: RunDll32.exe run from the control panel on this asset<br> ↳ <b>A-Powershell-Exec-DLL</b>: PowerShell Strings applied to rundllas.exe seen in PowerShdll.dll on this asset.<br> ↳ <b>A-EPA-DLL</b>: Dll loaded from a temp folder via PowerShell on this asset<br> ↳ <b>RunDll32-ControlPanel</b>: RunDll32.exe run from control panel<br> ↳ <b>Powershell-Exec-DLL</b>: PowerShell Strings applied to rundllas.exe seen in PowerShdll.dll<br> ↳ <b>EPA-DLL</b>: Dll loaded from a temp folder via PowerShell<br><br><b>T1218.003 - Signed Binary Proxy Execution: CMSTP</b><br> ↳ <b>A-UAC-Bypass-COM-OBJECT</b>: Windows UAC bypass using COM object access on this asset<br> ↳ <b>A-Bypass-UAC-CMSTP</b>: Child process of automatically elevated instance of Microsoft Connection Manager Profile Installer (cmstp.exe) was created via command line on this asset.<br> ↳ <b>UAC-Bypass-COM-OBJECT</b>: Windows UAC bypass using COM object access<br> ↳ <b>Bypass-UAC-CMSTP</b>: Child process of automatically elevated instance of Microsoft Connection Manager Profile Installer (cmstp.exe) was created via command line.<br><br><b>T1548.002 - Abuse Elevation Control Mechanism: Bypass User Account Control</b><br> ↳ <b>A-UAC-Bypass-COM-OBJECT</b>: Windows UAC bypass using COM object access on this asset<br> ↳ <b>A-UAC-Bypass-Fodhelper</b>: UAC Bypass using fodhelper.exe on this asset<br> ↳ <b>A-UAC-Bypass-Wsreset</b>: UAC Bypass using wsreset.exe on this asset<br> ↳ <b>A-Bypass-UAC-CMSTP</b>: Child process of automatically elevated instance of Microsoft Connection Manager Profile Installer (cmstp.exe) was created via command line on this asset.<br> ↳ <b>UAC-Bypass-COM-OBJECT</b>: Windows UAC bypass using COM object access<br> ↳ <b>UAC-Bypass-Fodhelper</b>: UAC Bypass using fodhelper.exe<br> ↳ <b>UAC-Bypass-Wsreset</b>: UAC Bypass using wsreset.exe<br> ↳ <b>Bypass-UAC-CMSTP</b>: Child process of automatically elevated instance of Microsoft Connection Manager Profile Installer (cmstp.exe) was created via command line.<br><br><b>T1027 - Obfuscated Files or Information</b><br> ↳ <b>A-Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity on this asset, suspicious command line arguments<br> ↳ <b>Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity, suspicious command line arguments<br><br><b>T1036.004 - T1036.004</b><br> ↳ <b>A-Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity on this asset, suspicious command line arguments<br> ↳ <b>Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity, suspicious command line arguments<br><br><b>T1059.003 - T1059.003</b><br> ↳ <b>A-SETUPCOMPLETE-PRIV-ESC</b>: Privilege escalation attempt using the SetupComplete.cmd object on this asset<br> ↳ <b>A-Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity on this asset, suspicious command line arguments<br> ↳ <b>SETUPCOMPLETE-PRIV-ESC</b>: Privilege escalation attempt using the SetupComplete.cmd object<br> ↳ <b>Operation-Wocao-Activity</b>: Possible Operation-Wocao APT activity, suspicious command line arguments<br><br><b>T1547.002 - T1547.002</b><br> ↳ <b>DLL-SideLoading</b>: DLL sideloading malware used, known artifact of APT27<br><br><b>T1574 - Hijack Execution Flow</b><br> ↳ <b>A-SETUPCOMPLETE-PRIV-ESC</b>: Privilege escalation attempt using the SetupComplete.cmd object on this asset<br> ↳ <b>SETUPCOMPLETE-PRIV-ESC</b>: Privilege escalation attempt using the SetupComplete.cmd object<br> ↳ <b>DLL-SideLoading</b>: DLL sideloading malware used, known artifact of APT27<br><br><b>T1082 - System Information Discovery</b><br> ↳ <b>A-EPA-OH-HENUM-F</b>: Asset running host enumeration tool for the first time<br> ↳ <b>A-EPA-OH-HENUM-A</b>: Abnormal for this asset to run host enumeration tool<br> ↳ <b>A-NET-EXE-Recon</b>: Enumeration and reconnaissance activities were performed on this asset<br> ↳ <b>EPA-OU-HENUM-F</b>: First user running host enumeration tool<br> ↳ <b>EPA-OU-HENUM-A</b>: Abnormal for this user to run host enumeration tool<br> ↳ <b>EPA-OH-HENUM-F</b>: Host running host enumeration tool for the first time<br> ↳ <b>EPA-OH-HENUM-A</b>: Abnormal for this host to run host enumeration tool<br> ↳ <b>NET-EXE-Recon</b>: Enumeration and reconnaissance activities were performed<br><br><b>T1087 - Account Discovery</b><br> ↳ <b>A-NET-EXE-Recon</b>: Enumeration and reconnaissance activities were performed on this asset<br> ↳ <b>NET-EXE-Recon</b>: Enumeration and reconnaissance activities were performed<br><br><b>T1482 - Domain Trust Discovery</b><br> ↳ <b>A-DomainTrust-Discovery</b>: Enumeration of Windows Domain Trusts identified on this asset<br> ↳ <b>DomainTrust-Discovery</b>: Enumeration of Windows Domain Trusts identified<br><br><b>T1222.001 - File and Directory Permissions Modification: Windows File and Directory Permissions Modification</b><br> ↳ <b>A-File-Folder-Perm-Mod</b>: The permissions of a file or folder were modified on this asset.<br> ↳ <b>File-Folder-Perm-Mod</b>: The permissions of a file or folder were modified.<br><br><b>T1574.002 - Hijack Execution Flow: DLL Side-Loading</b><br> ↳ <b>A-Sus-GUP-Usage</b>: Execution of the Notepad++ updater in a suspicious directory on this asset.<br> ↳ <b>PlugX-DLL-Sideloading</b>: DLL loaded from suspicous location typically seen by the PlugX malware family<br> ↳ <b>Sus-GUP-Usage</b>: Execution of the Notepad++ updater in a suspicious directory.<br><br><b>T1027.004 - Obfuscated Files or Information: Compile After Delivery</b><br> ↳ <b>CSC-Suspicious-Folder</b>: Csc.exe spawned from suspicious folder<br><br><b>T1218.010 - Signed Binary Proxy Execution: Regsvr32</b><br> ↳ <b>A-DLL-AppData</b>: DLL loaded from 'AppData(slash)Local' path on this asset<br> ↳ <b>DLL-AppData</b>: DLL loaded from 'AppData(slash)Local' path<br><br><b>T1484.001 - T1484.001</b><br> ↳ <b>OG-SYSVOL-F</b>: Suspicious SYSVOL Domain Group Policy Access for the first time for this peer group<br> ↳ <b>OG-SYSVOL-A</b>: Abnormal SYSVOL Domain Group Policy Access for thjis peer group<br><br><b>T1552.006 - T1552.006</b><br> ↳ <b>OG-SYSVOL-F</b>: Suspicious SYSVOL Domain Group Policy Access for the first time for this peer group<br> ↳ <b>OG-SYSVOL-A</b>: Abnormal SYSVOL Domain Group Policy Access for thjis peer group<br><br><b>T1558.003 - Steal or Forge Kerberos Tickets: Kerberoasting</b><br> ↳ <b>A-POSS-SPN-ENUMERATION</b>: Possible SPN Enumeration on this asset<br> ↳ <b>POSS-SPN-ENUMERATION</b>: Possible SPN Enumeration<br><br><b>T1003 - OS Credential Dumping</b><br> ↳ <b>A-ShadowCP-SymLink</b>: Shadow Copies Access via Symlink on this asset<br> ↳ <b>ShadowCP-SymLink</b>: Shadow Copies Access via Symlink<br><br><b>T1543.003 - Create or Modify System Process: Windows Service</b><br> ↳ <b>A-New-Service</b>: New windows service created using sc.exe on this asset<br> ↳ <b>New-Service</b>: New windows service created<br><br><b>T1053.005 - Scheduled Task/Job: Scheduled Task</b><br> ↳ <b>A-PrivEsc-SchedTask-LegacyDACL</b>: Possible privilege escalation using a legacy task file on this asset<br> ↳ <b>PrivEsc-SchedTask-LegacyDACL</b>: Possible privilege escalation using a legacy task file<br><br><b>T1574.011 - T1574.011</b><br> ↳ <b>A-Possible-PrivEsc-SvcPerms</b>: Possible privilege escalation using weak service permissions on this asset<br> ↳ <b>Possible-PrivEsc-SvcPerms</b>: Possible privilege escalation using weak service permissions<br><br><b>T1134.001 - Access Token Manipulation: Token Impersonation/Theft</b><br> ↳ <b>Suspicious-GetSystem-Usage</b>: Possible Meterpeter/Cobalt Strike usage of GetSystem<br><br><b>T1134.002 - T1134.002</b><br> ↳ <b>Suspicious-GetSystem-Usage</b>: Possible Meterpeter/Cobalt Strike usage of GetSystem<br><br><b>T1053.002 - Scheduled Task/Job: At (Windows)</b><br> ↳ <b>A-INTERACTIVE-JOB</b>: Interactive job from the 'at' program seen on this asset<br> ↳ <b>INTERACTIVE-JOB</b>: Interactive job from the 'at' program<br><br><b>T1068 - Exploitation for Privilege Escalation</b><br> ↳ <b>A-UAC-IE-INVOKE</b>: Windows UAC consent dialogue was used to invoke an Internet Explorer process running as Local SYSTEM<br> ↳ <b>A-APT-Hurricane-Panda</b>: Artifacts used by the APT group 'Hurricane Panda' have been observed on this asset<br> ↳ <b>A-SETUPCOMPLETE-PRIV-ESC</b>: Privilege escalation attempt using the SetupComplete.cmd object on this asset<br> ↳ <b>APT-Hurricane-Panda</b>: Artifacts used by the APT group 'Hurricane Panda' have been observed<br> ↳ <b>SETUPCOMPLETE-PRIV-ESC</b>: Privilege escalation attempt using the SetupComplete.cmd object<br><br><b>T1087.001 - Account Discovery: Local Account</b><br> ↳ <b>A-EPA-UP-CENUM</b>: Abnormal number of unique credential enumeration tools run on this asset<br> ↳ <b>A-EPA-OH-CENUM-F</b>: Asset running credential enumeration tool for the first time<br> ↳ <b>A-EPA-OH-CENUM-A</b>: Abnormal for this asset to run credential enumeration tool<br> ↳ <b>A-AccountDiscovery</b>: Local accounts were enumerated on this asset<br> ↳ <b>EPA-OU-CENUM-F</b>: First user running credential enumeration tool<br> ↳ <b>EPA-OU-CENUM-A</b>: Abnormal for this user to run credential enumeration tool<br> ↳ <b>EPA-OH-CENUM-F</b>: Host running credential enumeration tool for the first time<br> ↳ <b>EPA-OH-CENUM-A</b>: Abnormal for this host to run credential enumeration tool<br><br><b>T1087.002 - Account Discovery: Domain Account</b><br> ↳ <b>A-EPA-UP-CENUM</b>: Abnormal number of unique credential enumeration tools run on this asset<br> ↳ <b>A-EPA-OH-CENUM-F</b>: Asset running credential enumeration tool for the first time<br> ↳ <b>A-EPA-OH-CENUM-A</b>: Abnormal for this asset to run credential enumeration tool<br> ↳ <b>EPA-OU-CENUM-F</b>: First user running credential enumeration tool<br> ↳ <b>EPA-OU-CENUM-A</b>: Abnormal for this user to run credential enumeration tool<br> ↳ <b>EPA-OH-CENUM-F</b>: Host running credential enumeration tool for the first time<br> ↳ <b>EPA-OH-CENUM-A</b>: Abnormal for this host to run credential enumeration tool<br><br><b>T1007 - System Service Discovery</b><br> ↳ <b>A-EPA-OH-HENUM-F</b>: Asset running host enumeration tool for the first time<br> ↳ <b>A-EPA-OH-HENUM-A</b>: Abnormal for this asset to run host enumeration tool<br> ↳ <b>EPA-OU-HENUM-F</b>: First user running host enumeration tool<br> ↳ <b>EPA-OU-HENUM-A</b>: Abnormal for this user to run host enumeration tool<br> ↳ <b>EPA-OH-HENUM-F</b>: Host running host enumeration tool for the first time<br> ↳ <b>EPA-OH-HENUM-A</b>: Abnormal for this host to run host enumeration tool<br><br><b>T1018 - Remote System Discovery</b><br> ↳ <b>A-EPA-OH-HENUM-F</b>: Asset running host enumeration tool for the first time<br> ↳ <b>A-EPA-OH-HENUM-A</b>: Abnormal for this asset to run host enumeration tool<br> ↳ <b>EPA-OU-HENUM-F</b>: First user running host enumeration tool<br> ↳ <b>EPA-OU-HENUM-A</b>: Abnormal for this user to run host enumeration tool<br> ↳ <b>EPA-OH-HENUM-F</b>: Host running host enumeration tool for the first time<br> ↳ <b>EPA-OH-HENUM-A</b>: Abnormal for this host to run host enumeration tool<br><br><b>T1049 - System Network Connections Discovery</b><br> ↳ <b>A-EPA-OH-HENUM-F</b>: Asset running host enumeration tool for the first time<br> ↳ <b>A-EPA-OH-HENUM-A</b>: Abnormal for this asset to run host enumeration tool<br> ↳ <b>EPA-OU-HENUM-F</b>: First user running host enumeration tool<br> ↳ <b>EPA-OU-HENUM-A</b>: Abnormal for this user to run host enumeration tool<br> ↳ <b>EPA-OH-HENUM-F</b>: Host running host enumeration tool for the first time<br> ↳ <b>EPA-OH-HENUM-A</b>: Abnormal for this host to run host enumeration tool<br><br><b>T1057 - Process Discovery</b><br> ↳ <b>A-EPA-OH-HENUM-F</b>: Asset running host enumeration tool for the first time<br> ↳ <b>A-EPA-OH-HENUM-A</b>: Abnormal for this asset to run host enumeration tool<br> ↳ <b>EPA-OU-HENUM-F</b>: First user running host enumeration tool<br> ↳ <b>EPA-OU-HENUM-A</b>: Abnormal for this user to run host enumeration tool<br> ↳ <b>EPA-OH-HENUM-F</b>: Host running host enumeration tool for the first time<br> ↳ <b>EPA-OH-HENUM-A</b>: Abnormal for this host to run host enumeration tool<br><br><b>T1135 - Network Share Discovery</b><br> ↳ <b>A-EPA-OH-HENUM-F</b>: Asset running host enumeration tool for the first time<br> ↳ <b>A-EPA-OH-HENUM-A</b>: Abnormal for this asset to run host enumeration tool<br> ↳ <b>EPA-OU-HENUM-F</b>: First user running host enumeration tool<br> ↳ <b>EPA-OU-HENUM-A</b>: Abnormal for this user to run host enumeration tool<br> ↳ <b>EPA-OH-HENUM-F</b>: Host running host enumeration tool for the first time<br> ↳ <b>EPA-OH-HENUM-A</b>: Abnormal for this host to run host enumeration tool<br><br><b>T1016 - System Network Configuration Discovery</b><br> ↳ <b>WINCMD-Arp</b>: 'Arp' program used<br> ↳ <b>WINCMD-WmiObject</b>: Powershell WMI object to enumerate network adapter was used<br><br><b>T1033 - System Owner/User Discovery</b><br> ↳ <b>A-WHOAMI-SYSTEM</b>: Whoami commanded executed by LOCAL SYSTEM<br> ↳ <b>A-AccountDiscovery</b>: Local accounts were enumerated on this asset<br><br><b>T1218.002 - Signed Binary Proxy Execution: Control Panel</b><br> ↳ <b>A-RunDll32-ControlPanel</b>: RunDll32.exe run from the control panel on this asset |  • <b>EPA-OG-SYSVOL</b>: SYSVOL domain group policy access by group in the organization<br> • <b>EPA-OH-CENUM</b>: Hosts on which credential enumeration tools are run<br> • <b>EPA-OU-CENUM</b>: Users running credential enumeration tools<br> • <b>EPA-OH-HENUM</b>: Hosts on which host enumeration tools are run<br> • <b>EPA-OU-HENUM</b>: Users running host enumeration tools<br> • <b>A-EPA-REG-WU</b>: Models reg query activity for windows update on the assets.<br> • <b>A-EPA-OH-CENUM</b>: Assets on which credential enumeration tools are run<br> • <b>A-EPA-UP-CENUM</b>: Unique credential enumeration tools run on this host<br> • <b>A-EPA-OH-HENUM</b>: Assets on which host enumeration tools are run |
| remote-logon    | <b>T1078 - Valid Accounts</b><br> ↳ <b>AS-PV-UHWoPC</b>: Access to Password Vault managed asset with no password checkout for user<br> ↳ <b>DC18-new</b>: Account switch by new user<br><br><b>T1555.005 - T1555.005</b><br> ↳ <b>AS-PV-UHWoPC</b>: Access to Password Vault managed asset with no password checkout for user    |  • <b>AS-PV-OA</b>: Password retrieval based accounts    |